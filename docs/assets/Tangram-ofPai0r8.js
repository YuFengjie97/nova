var j=Object.defineProperty;var D=(s,n,e)=>n in s?j(s,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[n]=e;var h=(s,n,e)=>(D(s,typeof n!="symbol"?n+"":n,e),e);import{P as B}from"./P5Con-WimvEu7X.js";import{a as M}from"./p5.min-GDl2HyFv.js";import{d as z,o as F,b as G,l as H}from"./index-LMOq6Ftv.js";function J(s,n){let e=!1;for(let o=0,r=s.length-1;o<s.length;o++)s[o].y>n[1]!=s[r].y>n[1]&&n[0]<(s[r].x-s[o].x)*(n[1]-s[o].y)/(s[r].y-s[o].y)+s[o].x&&(e=!e),r=o;return e}function L(s){let n=0,e,o,r,a;const u=s.length;for(e=0,o=u-1;e<u;o=e,e++)r=s[e],a=s[o],n+=r.x*a.y,n-=r.y*a.x;return n/=2,n}function I(s){let n=0,e=0,o,r,a,u,t;const m=s.length;for(o=0,r=m-1;o<m;r=o,o++)u=s[o],t=s[r],a=u.x*t.y-t.x*u.y,n+=(u.x+t.x)*a,e+=(u.y+t.y)*a;return a=L(s)*6,new M.Vector(n/a,e/a)}const U={class:"w-full h-full"},$=z({__name:"Tangram",setup(s){const{PI:n}=Math;let e,o,r,a,u;const t=400;let m,k,_,w,f=null;const A=n/180,c={},b=[{id:1,c:"#cd9670",center:[0,0],ps:[[0,0],[0,t],[t/2,t/2],[0,0]]},{id:2,c:"#f4444a",center:[0,0],ps:[[0,t],[t,t],[t/2,t/2],[0,t]]},{id:3,c:"#fd796d",center:[0,0],ps:[[0,0],[t/2,0],[t/4,t/4],[0,0]]},{id:4,c:"#e7d02d",center:[0,0],ps:[[t/2,0],[t/4,t/4],[t/2,t/2],[t*3/4,t/4],[t/2,0]]},{id:5,c:"#f9b02d",center:[0,0],ps:[[t*3/4,t/4],[t*3/4,t*3/4],[t/2,t/2],[t*3/4,t/4]]},{id:6,c:"#acc94a",center:[0,0],ps:[[t*3/4,t/4],[t,t/2],[t,t],[t*3/4,t*3/4],[t*3/4,t/4]]},{id:7,c:"#59afcb",center:[0,0],ps:[[t/2,0],[t,0],[t,t/2],[t/2,0]]}];class R{constructor(l,d,p){h(this,"id");h(this,"center");h(this,"points");h(this,"color");h(this,"prePos",null);h(this,"curPos",e.createVector(0,0));h(this,"angle",0);this.id=l,this.color=d,this.points=p.map(g=>(g.set(g.x+a,g.y+u),g)),this.center=I(p);const{x:y,y:P}=this.center;console.log(this.id,y,P)}draw(){const{color:l,points:d,center:p,angle:y}=this,{x:P,y:g}=p;e.push(),e.translate(p.x,p.y),e.rotate(y),e.fill(l),e.stroke("#000"),e.strokeJoin(e.ROUND),e.strokeWeight(4),e.beginShape();for(let x=0,T=d.length;x<T;x++)e.vertex(d[x].x-P,d[x].y-g);e.endShape(),e.pop()}updatePoints(){if(this.center=I(this.points),f===this.id){this.prePos||(this.prePos=e.createVector(_,w)),this.curPos.set(m,k);const l=this.curPos.copy().sub(this.prePos);for(let d=0,p=this.points.length;d<p;d++)this.points[d].add(l);this.prePos.set(m,k)}else this.prePos=null}updateAngle(l){this.angle+=l?A:-A,console.log(this.angle)}}function S(){for(let i=0,l=b.length;i<l;i++){const{id:d,c:p,ps:y}=b[i];c[d]=new R(d,p,y.map(P=>e.createVector(...P)))}}function O(){for(const i in c)c.hasOwnProperty(i)&&(f===c[i].id&&(e.keyIsPressed&&e.key==="a"?c[f].updateAngle(!1):e.keyIsPressed&&e.key==="d"&&c[f].updateAngle(!0)),c[i].updatePoints(),c[i].draw())}function V(){m=e.pmouseX,k=e.pmouseY}function C(){const i=`
    鼠标左键摁住拖拽，
    键盘A/D大幅度旋转，
    键盘<-/->小幅度旋转
  `;e.fill("#000"),e.noStroke(),e.textSize(20),e.textWrap(e.WORD),e.textAlign(e.CENTER),e.text(i,o/2-250,10,500)}function W(i){o=i.width,r=i.height,a=o/2-t/2,u=r/2-t/2,e=i,S()}function X(){e.background("#8e44ad"),C(),V(),O()}function Y(){_=e.mouseX,w=e.mouseY;for(const i in c){const l=String(8-Number(i));if(c.hasOwnProperty(l)&&J(c[l].points,[_,w])){f=c[l].id;break}}}function E(){f=null}function N(){f&&(e.keyCode===e.LEFT_ARROW?c[f].updateAngle(!1):e.keyCode===e.RIGHT_ARROW&&c[f].updateAngle(!0))}return(i,l)=>(F(),G("div",U,[H(B,{setup:W,draw:X,"mouse-pressed":Y,"mouse-released":E,"key-pressed":N})]))}});export{$ as default};
