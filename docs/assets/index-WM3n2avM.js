const N=11102230246251565e-32,D=134217729,nt=(3+8*N)*N;function O(h,t,s,r,u){let i,e,l,y,f=t[0],b=r[0],n=0,o=0;b>f==b>-f?(i=f,f=t[++n]):(i=b,b=r[++o]);let c=0;if(n<h&&o<s)for(b>f==b>-f?(e=f+i,l=i-(e-f),f=t[++n]):(e=b+i,l=i-(e-b),b=r[++o]),i=e,l!==0&&(u[c++]=l);n<h&&o<s;)b>f==b>-f?(e=i+f,y=e-i,l=i-(e-y)+(f-y),f=t[++n]):(e=i+b,y=e-i,l=i-(e-y)+(b-y),b=r[++o]),i=e,l!==0&&(u[c++]=l);for(;n<h;)e=i+f,y=e-i,l=i-(e-y)+(f-y),f=t[++n],i=e,l!==0&&(u[c++]=l);for(;o<s;)e=i+b,y=e-i,l=i-(e-y)+(b-y),b=r[++o],i=e,l!==0&&(u[c++]=l);return(i!==0||c===0)&&(u[c++]=i),c}function it(h,t){let s=t[0];for(let r=1;r<h;r++)s+=t[r];return s}function Q(h){return new Float64Array(h)}const et=(3+16*N)*N,st=(2+12*N)*N,lt=(9+64*N)*N*N,F=Q(4),J=Q(8),V=Q(12),W=Q(16),L=Q(4);function ot(h,t,s,r,u,i,e){let l,y,f,b,n,o,c,d,_,g,w,m,A,I,z,M,U,T;const K=h-u,a=s-u,p=t-i,x=r-i;I=K*x,o=D*K,c=o-(o-K),d=K-c,o=D*x,_=o-(o-x),g=x-_,z=d*g-(I-c*_-d*_-c*g),M=p*a,o=D*p,c=o-(o-p),d=p-c,o=D*a,_=o-(o-a),g=a-_,U=d*g-(M-c*_-d*_-c*g),w=z-U,n=z-w,F[0]=z-(w+n)+(n-U),m=I+w,n=m-I,A=I-(m-n)+(w-n),w=A-M,n=A-w,F[1]=A-(w+n)+(n-M),T=m+w,n=T-m,F[2]=m-(T-n)+(w-n),F[3]=T;let k=it(4,F),v=st*e;if(k>=v||-k>=v||(n=h-K,l=h-(K+n)+(n-u),n=s-a,f=s-(a+n)+(n-u),n=t-p,y=t-(p+n)+(n-i),n=r-x,b=r-(x+n)+(n-i),l===0&&y===0&&f===0&&b===0)||(v=lt*e+nt*Math.abs(k),k+=K*b+x*l-(p*f+a*y),k>=v||-k>=v))return k;I=l*x,o=D*l,c=o-(o-l),d=l-c,o=D*x,_=o-(o-x),g=x-_,z=d*g-(I-c*_-d*_-c*g),M=y*a,o=D*y,c=o-(o-y),d=y-c,o=D*a,_=o-(o-a),g=a-_,U=d*g-(M-c*_-d*_-c*g),w=z-U,n=z-w,L[0]=z-(w+n)+(n-U),m=I+w,n=m-I,A=I-(m-n)+(w-n),w=A-M,n=A-w,L[1]=A-(w+n)+(n-M),T=m+w,n=T-m,L[2]=m-(T-n)+(w-n),L[3]=T;const j=O(4,F,4,L,J);I=K*b,o=D*K,c=o-(o-K),d=K-c,o=D*b,_=o-(o-b),g=b-_,z=d*g-(I-c*_-d*_-c*g),M=p*f,o=D*p,c=o-(o-p),d=p-c,o=D*f,_=o-(o-f),g=f-_,U=d*g-(M-c*_-d*_-c*g),w=z-U,n=z-w,L[0]=z-(w+n)+(n-U),m=I+w,n=m-I,A=I-(m-n)+(w-n),w=A-M,n=A-w,L[1]=A-(w+n)+(n-M),T=m+w,n=T-m,L[2]=m-(T-n)+(w-n),L[3]=T;const E=O(j,J,4,L,V);I=l*b,o=D*l,c=o-(o-l),d=l-c,o=D*b,_=o-(o-b),g=b-_,z=d*g-(I-c*_-d*_-c*g),M=y*f,o=D*y,c=o-(o-y),d=y-c,o=D*f,_=o-(o-f),g=f-_,U=d*g-(M-c*_-d*_-c*g),w=z-U,n=z-w,L[0]=z-(w+n)+(n-U),m=I+w,n=m-I,A=I-(m-n)+(w-n),w=A-M,n=A-w,L[1]=A-(w+n)+(n-M),T=m+w,n=T-m,L[2]=m-(T-n)+(w-n),L[3]=T;const S=O(E,V,4,L,W);return W[S-1]}function X(h,t,s,r,u,i){const e=(t-i)*(s-u),l=(h-u)*(r-i),y=e-l,f=Math.abs(e+l);return Math.abs(y)>=et*f?y:-ot(h,t,s,r,u,i,f)}const Z=Math.pow(2,-52),Y=new Uint32Array(512);class ${static from(t,s=ut,r=ft){const u=t.length,i=new Float64Array(u*2);for(let e=0;e<u;e++){const l=t[e];i[2*e]=s(l),i[2*e+1]=r(l)}return new $(i)}constructor(t){const s=t.length>>1;if(s>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*s-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(s)),this._hullPrev=new Uint32Array(s),this._hullNext=new Uint32Array(s),this._hullTri=new Uint32Array(s),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(s),this._dists=new Float64Array(s),this.update()}update(){const{coords:t,_hullPrev:s,_hullNext:r,_hullTri:u,_hullHash:i}=this,e=t.length>>1;let l=1/0,y=1/0,f=-1/0,b=-1/0;for(let a=0;a<e;a++){const p=t[2*a],x=t[2*a+1];p<l&&(l=p),x<y&&(y=x),p>f&&(f=p),x>b&&(b=x),this._ids[a]=a}const n=(l+f)/2,o=(y+b)/2;let c=1/0,d,_,g;for(let a=0;a<e;a++){const p=R(n,o,t[2*a],t[2*a+1]);p<c&&(d=a,c=p)}const w=t[2*d],m=t[2*d+1];c=1/0;for(let a=0;a<e;a++){if(a===d)continue;const p=R(w,m,t[2*a],t[2*a+1]);p<c&&p>0&&(_=a,c=p)}let A=t[2*_],I=t[2*_+1],z=1/0;for(let a=0;a<e;a++){if(a===d||a===_)continue;const p=ct(w,m,A,I,t[2*a],t[2*a+1]);p<z&&(g=a,z=p)}let M=t[2*g],U=t[2*g+1];if(z===1/0){for(let x=0;x<e;x++)this._dists[x]=t[2*x]-t[0]||t[2*x+1]-t[1];G(this._ids,this._dists,0,e-1);const a=new Uint32Array(e);let p=0;for(let x=0,k=-1/0;x<e;x++){const v=this._ids[x];this._dists[v]>k&&(a[p++]=v,k=this._dists[v])}this.hull=a.subarray(0,p),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(X(w,m,A,I,M,U)<0){const a=_,p=A,x=I;_=g,A=M,I=U,g=a,M=p,U=x}const T=at(w,m,A,I,M,U);this._cx=T.x,this._cy=T.y;for(let a=0;a<e;a++)this._dists[a]=R(t[2*a],t[2*a+1],T.x,T.y);G(this._ids,this._dists,0,e-1),this._hullStart=d;let K=3;r[d]=s[g]=_,r[_]=s[d]=g,r[g]=s[_]=d,u[d]=0,u[_]=1,u[g]=2,i.fill(-1),i[this._hashKey(w,m)]=d,i[this._hashKey(A,I)]=_,i[this._hashKey(M,U)]=g,this.trianglesLen=0,this._addTriangle(d,_,g,-1,-1,-1);for(let a=0,p,x;a<this._ids.length;a++){const k=this._ids[a],v=t[2*k],j=t[2*k+1];if(a>0&&Math.abs(v-p)<=Z&&Math.abs(j-x)<=Z||(p=v,x=j,k===d||k===_||k===g))continue;let E=0;for(let B=0,tt=this._hashKey(v,j);B<this._hashSize&&(E=i[(tt+B)%this._hashSize],!(E!==-1&&E!==r[E]));B++);E=s[E];let S=E,C;for(;C=r[S],X(v,j,t[2*S],t[2*S+1],t[2*C],t[2*C+1])>=0;)if(S=C,S===E){S=-1;break}if(S===-1)continue;let q=this._addTriangle(S,k,r[S],-1,-1,u[S]);u[k]=this._legalize(q+2),u[S]=q,K++;let P=r[S];for(;C=r[P],X(v,j,t[2*P],t[2*P+1],t[2*C],t[2*C+1])<0;)q=this._addTriangle(P,k,C,u[k],-1,u[P]),u[k]=this._legalize(q+2),r[P]=P,K--,P=C;if(S===E)for(;C=s[S],X(v,j,t[2*C],t[2*C+1],t[2*S],t[2*S+1])<0;)q=this._addTriangle(C,k,S,-1,u[S],u[C]),this._legalize(q+2),u[C]=q,r[S]=S,K--,S=C;this._hullStart=s[k]=S,r[S]=s[P]=k,r[k]=P,i[this._hashKey(v,j)]=k,i[this._hashKey(t[2*S],t[2*S+1])]=S}this.hull=new Uint32Array(K);for(let a=0,p=this._hullStart;a<K;a++)this.hull[a]=p,p=r[p];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,s){return Math.floor(ht(t-this._cx,s-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:s,_halfedges:r,coords:u}=this;let i=0,e=0;for(;;){const l=r[t],y=t-t%3;if(e=y+(t+2)%3,l===-1){if(i===0)break;t=Y[--i];continue}const f=l-l%3,b=y+(t+1)%3,n=f+(l+2)%3,o=s[e],c=s[t],d=s[b],_=s[n];if(rt(u[2*o],u[2*o+1],u[2*c],u[2*c+1],u[2*d],u[2*d+1],u[2*_],u[2*_+1])){s[t]=_,s[l]=o;const w=r[n];if(w===-1){let A=this._hullStart;do{if(this._hullTri[A]===n){this._hullTri[A]=t;break}A=this._hullPrev[A]}while(A!==this._hullStart)}this._link(t,w),this._link(l,r[e]),this._link(e,n);const m=f+(l+1)%3;i<Y.length&&(Y[i++]=m)}else{if(i===0)break;t=Y[--i]}}return e}_link(t,s){this._halfedges[t]=s,s!==-1&&(this._halfedges[s]=t)}_addTriangle(t,s,r,u,i,e){const l=this.trianglesLen;return this._triangles[l]=t,this._triangles[l+1]=s,this._triangles[l+2]=r,this._link(l,u),this._link(l+1,i),this._link(l+2,e),this.trianglesLen+=3,l}}function ht(h,t){const s=h/(Math.abs(h)+Math.abs(t));return(t>0?3-s:1+s)/4}function R(h,t,s,r){const u=h-s,i=t-r;return u*u+i*i}function rt(h,t,s,r,u,i,e,l){const y=h-e,f=t-l,b=s-e,n=r-l,o=u-e,c=i-l,d=y*y+f*f,_=b*b+n*n,g=o*o+c*c;return y*(n*g-_*c)-f*(b*g-_*o)+d*(b*c-n*o)<0}function ct(h,t,s,r,u,i){const e=s-h,l=r-t,y=u-h,f=i-t,b=e*e+l*l,n=y*y+f*f,o=.5/(e*f-l*y),c=(f*b-l*n)*o,d=(e*n-y*b)*o;return c*c+d*d}function at(h,t,s,r,u,i){const e=s-h,l=r-t,y=u-h,f=i-t,b=e*e+l*l,n=y*y+f*f,o=.5/(e*f-l*y),c=h+(f*b-l*n)*o,d=t+(e*n-y*b)*o;return{x:c,y:d}}function G(h,t,s,r){if(r-s<=20)for(let u=s+1;u<=r;u++){const i=h[u],e=t[i];let l=u-1;for(;l>=s&&t[h[l]]>e;)h[l+1]=h[l--];h[l+1]=i}else{const u=s+r>>1;let i=s+1,e=r;H(h,u,i),t[h[s]]>t[h[r]]&&H(h,s,r),t[h[i]]>t[h[r]]&&H(h,i,r),t[h[s]]>t[h[i]]&&H(h,s,i);const l=h[i],y=t[l];for(;;){do i++;while(t[h[i]]<y);do e--;while(t[h[e]]>y);if(e<i)break;H(h,i,e)}h[s+1]=h[e],h[e]=l,r-i+1>=e-s?(G(h,t,i,r),G(h,t,s,e-1)):(G(h,t,s,e-1),G(h,t,i,r))}}function H(h,t,s){const r=h[t];h[t]=h[s],h[s]=r}function ut(h){return h[0]}function ft(h){return h[1]}export{$ as D};
