var W=Object.defineProperty;var X=(u,n,d)=>n in u?W(u,n,{enumerable:!0,configurable:!0,writable:!0,value:d}):u[n]=d;var C=(u,n,d)=>(X(u,typeof n!="symbol"?n+"":n,d),d);import{b as Y}from"./simplex-noise-BtZ5wMFy.js";import{d as q,r as H,j as J,aZ as Q,K as tt,N as S,Y as et,Z,a0 as st,aO as nt,X as ot,a1 as it,e as rt,o as at}from"./index-C5HxIGZc.js";import{c as ct}from"./chroma-Y-Vb8avc.js";import{p as lt}from"./dotTexture-NXlc0I5v.js";const I=1e4,g=100,w=4,D=2,gt=q({__name:"flowFieldPoint3D",setup(u){const{random:n,PI:d,sin:F,cos:E,floor:z}=Math,L=ct.scale(["#00b894","#0984e3","#6c5ce7","#fdcb6e","#e84393"]),T=Y(),b=H(),t=new Float32Array(I*3),v=new Float32Array(I*3);let a=0,c=0,o=20;const R=[],y={};class U{constructor(i){C(this,"ind");C(this,"vel");this.ind=i,this.vel=new S(0,0,0)}getPos(){return{x:t[this.ind*3],y:t[this.ind*3+1],z:t[this.ind*3+2]}}edge(){const{x:i,y:f,z:h}=this.getPos();i<0&&(t[this.ind*3]=a),i>a&&(t[this.ind*3]=0),f<0&&(t[this.ind*3+1]=c),f>c&&(t[this.ind*3+1]=0),h<0&&(t[this.ind*3+2]=g),h>g&&(t[this.ind*3+2]=0)}update(i,f){this.edge();const[h,_,M]=L(i).gl();v[this.ind*3]=h,v[this.ind*3+1]=_,v[this.ind*3+2]=M,this.vel.add(f),this.vel.length()>D&&this.vel.setLength(D),t[this.ind*3]+=this.vel.x,t[this.ind*3+1]+=this.vel.y,t[this.ind*3+2]+=this.vel.z}}return J(()=>{const{width:$,height:i}=b.value.getBoundingClientRect();a=$/4,c=i/4,o=i/40;const{scene:f,camera:h,renderWrap:_,orbitControls:M}=Q(b.value,!1,!1,!1);h.position.set(a/2,c/2,g*2),h.lookAt(a/2,c/2,0),f.background=new tt(0);for(let e=-1;e*o<a+o;e+=1)for(let s=-1;s*o<c+o;s+=1)for(let r=-1;r*w<g+w;r+=1)y[`${e},${s},${r}`]={n:0,v:new S(0,0,0)};for(let e=0;e<I;e++){const s=n()*a,r=n()*c,l=n()*g;t[e*3]=s,t[e*3+1]=r,t[e*3+2]=l,R.push(new U(e))}const A=new et;A.setAttribute("position",new Z(t,3)),A.setAttribute("color",new Z(v,3));const j=new st({size:1.5,map:new nt().load(lt),blending:ot,transparent:!1,sizeAttenuation:!0,vertexColors:!0}),P=new it(A,j);f.add(P);const G=.05,K=.05,O=.01;let N=0;const V=.01;_(()=>{N+=V;let e=0;for(let s=-1;s*o<a+o;s+=1){e+=G;let r=0;for(let l=-1;l*o<c+o;l+=1){r+=K;let x=0;for(let p=-1;p*w<g+w;p+=1){x+=O;const m=T(e,r,x,N)*.5+.5,B=4*d*m,k=D*.1*m;y[`${s},${l},${p}`].n=m,y[`${s},${l},${p}`].v.set(E(B)*k,F(B)*k,F(B)*k)}}}R.forEach(s=>{const{x:r,y:l,z:x}=s.getPos(),{n:p,v:m}=y[`${z(r/o)},${z(l/o)},${z(x/w)}`];s.update(p,m)}),P.geometry.attributes.position.needsUpdate=!0,P.geometry.attributes.color.needsUpdate=!0})()}),($,i)=>(at(),rt("div",{ref_key:"con",ref:b,class:"w-full h-full"},null,512))}});export{gt as default};
