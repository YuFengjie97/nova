var z=Object.defineProperty;var D=(m,n,l)=>n in m?z(m,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):m[n]=l;var p=(m,n,l)=>(D(m,typeof n!="symbol"?n+"":n,l),l);import{c as H}from"./chroma-D8b-vtvi.js";import{i as J}from"./initStats-z-qGLZo8.js";import{i as K}from"./initGUI-CcmszmDW.js";import{d as Q,r as S,j as T,G as W,e as X,f as Y,o as Z}from"./index-Dk52mj26.js";import"./dat.gui.module-DcMWPYuf.js";const r=10,y=1.6,j=.98,ct=Q({__name:"particleLife",setup(m){const{random:n,PI:l,min:A,abs:tt,sqrt:E,floor:k}=Math,x=S(),F=S(),N=H.scale(["#fd79a8","#81ecec","#00cec9","#d63031"]),R=r*100,M=[];let g=10,_=100,P=100,b=50,w=.5;function q(){for(let a=0;a<r;a++){const s=[];for(let h=0;h<r;h++)s.push(n()*2-1);M.push(s)}}q();function U(){for(let a=0;a<r;a++)for(let s=0;s<r;s++)M[a][s]=k(n()*2-1)}let G=0;return T(()=>{const{width:a,height:s}=x.value.getBoundingClientRect();F.value.width=a,F.value.height=s;const h=F.value.getContext("2d"),{stats:$}=J(x.value),{gui:L}=K(x.value),v={distMin:g,distMax:_,frictionFactor:j,pullFactor:P,pushFactor:b,tail:w,reset(){U(),I()}},f=L.addFolder("setting");f.open(),f.add(v,"distMin",0,20,1).onChange(t=>{g=t}),f.add(v,"pushFactor",1,200,1).onChange(t=>{b=t}),f.add(v,"distMax",20,k(A(a,s)),1).onChange(t=>{_=t}),f.add(v,"pullFactor",1,200,1).onChange(t=>{P=t}),f.add(v,"tail",0,1,.1).onFinishChange(t=>{w=t,h.fillStyle=`rgba(0,0,0,${1-w})`}),f.add(v,"reset");class O{constructor(e,o,c){p(this,"x",0);p(this,"y",0);p(this,"vx",0);p(this,"vy",0);p(this,"type",0);p(this,"canvasoff");this.x=e,this.y=o,this.type=c;const u=document.createElement("canvas");u.width=y*2,u.height=y*2;const i=u.getContext("2d"),C=N(c/r).css();i.beginPath(),i.fillStyle=C,i.arc(y,y,y,0,2*l),i.fill(),i.closePath(),this.canvasoff=u}edge(){return this.x<0||this.x>a||this.y<0||this.y>s?(this.x=n()*a,this.y=n()*s,!0):!1}accletorForce(e,o){return e<=g?(e/g-1)*P:e<_?b*o*(e-g)/(_-g):0}updateForce(e){const o=M[this.type][e.type],c=e.x-this.x,u=e.y-this.y,i=E(c**2+u**2),C=this.accletorForce(i,o)*.001;this.vx+=c/i*C,this.vy+=u/i*C}update(){this.edge()||(this.vx*=j,this.vy*=j,this.x+=this.vx,this.y+=this.vy)}draw(){h.drawImage(this.canvasoff,this.x,this.y)}}setInterval(()=>{V()},100);const d=[];function I(){d.length=0;for(let t=0;t<r;t++)for(let e=0;e<R/r;e++)d.push(new O(n()*a,n()*s,t))}I();function V(){for(let t=0;t<d.length;t++){const e=d[t];for(let o=0;o<d.length;o++){if(t===o)continue;const c=d[o];e.updateForce(c),c.updateForce(e)}}}h.fillStyle=`rgba(0,0,0,${1-w})`;function B(){$.update(),h.fillRect(0,0,a,s),d.forEach(t=>{t.update(),t.draw()}),G=requestAnimationFrame(B)}B()}),W(()=>{cancelAnimationFrame(G)}),(a,s)=>(Z(),X("div",{ref_key:"con",ref:x,class:"w-full h-full"},[Y("canvas",{ref_key:"canvas",ref:F,class:"block w-full h-full"},null,512)],512))}});export{ct as default};
