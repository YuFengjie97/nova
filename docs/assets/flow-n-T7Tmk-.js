import{p as _}from"./p5.min-WfQBoNak.js";import{c as L}from"./simplex-noise-BkggsaiG.js";import{i as T}from"./initGUI-oTOkqKW2.js";import{d as V,r as M,C as W,j as b,H as A,e as U,f as X,o as Y}from"./index-CqfaNC88.js";import{m as l}from"./math-Cm0Zo__g.js";import"./dat.gui.module-DYGKXP-V.js";const H=V({__name:"flow",setup(Z){const S=L(),r=M(),c=M();let d=300,f=360,o=10,s=30,g=o*10,a=0,u=0,n,m=0,p=0,w=.001,C=.001,y=.004,x=!1;const i={hueBase:d,hueRange:f,lineWidth:o,cellSize:s,lineLen:g,xInc:w,yInc:C,zInc:y,isGlow:x};let I=0;return W(()=>{cancelAnimationFrame(I)}),b(()=>{function O(){const{width:t,height:e}=r.value.getBoundingClientRect();a=t,u=e,c.value.width=t,c.value.height=e,n=c.value.getContext("2d"),m=Math.ceil(e/s),p=Math.ceil(t/s),n.lineCap="round",n.lineWidth=o}O();const h=[];function k(){let t=null;return()=>{t&&clearTimeout(t),t=setTimeout(()=>{O(),h.length=0,v()},700)}}window.addEventListener("resize",k());function R(){const{gui:t}=T(r.value);t.add(i,"hueBase",1,360,1).onChange(e=>d=e),t.add(i,"hueRange",1,360,1).onChange(e=>f=e),t.add(i,"isGlow").name("isGlow(laggy)").onChange(e=>x=e),t.add(i,"cellSize",10,60,1).name("cellSize(careful)").onChange(e=>{s=e,h.length=0,m=Math.ceil(u/s),p=Math.ceil(a/s),v()}),t.add(i,"lineWidth",1,20,1).onChange(e=>{o=e,n.lineWidth=o}),t.add(i,"lineLen",1,200,1).onChange(e=>g=e),t.add(i,"xInc",.001,.01,.001).onChange(e=>w=e),t.add(i,"yInc",.001,.01,.001).onChange(e=>C=e),t.add(i,"zInc",.001,.01,.001).onChange(e=>y=e)}R();class G{constructor(e){this.end=new _.Vector(0,0),this.hue=0,this.xOff=0,this.yOff=0,this.zOff=0,this.pos=e,this.xOff=l(e.x,0,a,0,1),this.yOff=l(e.y,0,a,0,1),this.zOff=l(Math.sqrt(this.xOff+this.yOff),0,2,0,1)}draw(){n.beginPath(),n.moveTo(this.pos.x,this.pos.y),n.lineTo(this.end.x,this.end.y);const{hsl:e,grad:z}=this.getColor();n.strokeStyle=z,x?(n.shadowColor=e,n.shadowBlur=o/2):n.shadowBlur=0,n.stroke()}getColor(){this.hue=Math.floor(l(this.getNoiseXYZ(),-1,1,d-f,d+f));const e=n.createLinearGradient(this.pos.x,this.pos.y,this.end.x,this.end.y);return e.addColorStop(0,`hsla(${this.hue}, 100%, 50%, 0)`),e.addColorStop(1,`hsla(${this.hue}, 100%, 50%, 1)`),{hsl:`hsla(${this.hue}, 100%, 50%, 1)`,grad:e}}getNoiseXYZ(){return S(this.xOff,this.yOff,this.zOff)}update(){const e=this.getNoiseXYZ(),z=l(e,-1,1,0,Math.PI*4),E=l(e,-1,1,.1,g);this.end=this.pos.copy().add(_.Vector.fromAngle(z,E)),this.xOff+=w,this.yOff+=C,this.zOff+=y}}function v(){for(let t=0;t<p;t++)for(let e=0;e<m;e++)h.push(new G(new _.Vector(t*s,e*s)))}const{stats:N}=A(r.value);function B(){N.update(),n.clearRect(0,0,a,u),n.fillStyle="rgba(0,0,0,1)",n.fillRect(0,0,a,u),h.forEach(t=>{t.update(),t.draw()}),I=requestAnimationFrame(B)}v(),B()}),(O,h)=>(Y(),U("div",{ref_key:"con",ref:r,class:"h-100vh w-full"},[X("canvas",{ref_key:"canvas",ref:c,class:"h-full w-full block"},null,512)],512))}});export{H as default};
