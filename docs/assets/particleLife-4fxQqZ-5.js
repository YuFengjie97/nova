var z=Object.defineProperty;var D=(m,n,l)=>n in m?z(m,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):m[n]=l;var p=(m,n,l)=>(D(m,typeof n!="symbol"?n+"":n,l),l);import{c as H}from"./chroma-wKDBd-uV.js";import{i as J}from"./initStats-0J0VmoiC.js";import{i as K}from"./initGUI-4v9Pkg7m.js";import{d as Q,r as S,h as T,C as W,o as X,b as Y,e as Z}from"./index-w3o6Dwr7.js";import"./dat.gui.module-PWGADmkp.js";const ct=Q({__name:"particleLife",setup(m){const{random:n,PI:l,min:A,abs:tt,sqrt:E,floor:I}=Math,x=S(),F=S(),N=H.scale(["#fd79a8","#81ecec","#00cec9","#d63031"]),c=10,R=c*100,y=1.6,b=[];let g=10,C=100;const M=.98;let P=100,k=50,_=.5;function q(){for(let a=0;a<c;a++){const s=[];for(let h=0;h<c;h++)s.push(n()*2-1);b.push(s)}}q();function U(){for(let a=0;a<c;a++)for(let s=0;s<c;s++)b[a][s]=I(n()*2-1)}let j=0;return T(()=>{const{width:a,height:s}=x.value.getBoundingClientRect();F.value.width=a,F.value.height=s;const h=F.value.getContext("2d"),{stats:$}=J(x.value),{gui:L}=K(x.value),v={distMin:g,distMax:C,frictionFactor:M,pullFactor:P,pushFactor:k,tail:_,reset(){U(),B()}},f=L.addFolder("setting");f.open(),f.add(v,"distMin",0,20,1).onChange(t=>{g=t}),f.add(v,"pushFactor",1,200,1).onChange(t=>{k=t}),f.add(v,"distMax",20,I(A(a,s)),1).onChange(t=>{C=t}),f.add(v,"pullFactor",1,200,1).onChange(t=>{P=t}),f.add(v,"tail",0,1,.1).onFinishChange(t=>{_=t,h.fillStyle=`rgba(0,0,0,${1-_})`}),f.add(v,"reset");class O{constructor(e,o,r){p(this,"x",0);p(this,"y",0);p(this,"vx",0);p(this,"vy",0);p(this,"type",0);p(this,"canvasoff");this.x=e,this.y=o,this.type=r;const u=document.createElement("canvas");u.width=y*2,u.height=y*2;const i=u.getContext("2d"),w=N(r/c).css();i.beginPath(),i.fillStyle=w,i.arc(y,y,y,0,2*l),i.fill(),i.closePath(),this.canvasoff=u}edge(){return this.x<0||this.x>a||this.y<0||this.y>s?(this.x=n()*a,this.y=n()*s,!0):!1}accletorForce(e,o){return e<=g?(e/g-1)*P:e<C?k*o*(e-g)/(C-g):0}updateForce(e){const o=b[this.type][e.type],r=e.x-this.x,u=e.y-this.y,i=E(r**2+u**2),w=this.accletorForce(i,o)*.001;this.vx+=r/i*w,this.vy+=u/i*w}update(){this.edge()||(this.vx*=M,this.vy*=M,this.x+=this.vx,this.y+=this.vy)}draw(){h.drawImage(this.canvasoff,this.x,this.y)}}setInterval(()=>{V()},100);const d=[];function B(){d.length=0;for(let t=0;t<c;t++)for(let e=0;e<R/c;e++)d.push(new O(n()*a,n()*s,t))}B();function V(){for(let t=0;t<d.length;t++){const e=d[t];for(let o=0;o<d.length;o++){if(t===o)continue;const r=d[o];e.updateForce(r),r.updateForce(e)}}}h.fillStyle=`rgba(0,0,0,${1-_})`;function G(){$.update(),h.fillRect(0,0,a,s),d.forEach(t=>{t.update(),t.draw()}),j=requestAnimationFrame(G)}G()}),W(()=>{cancelAnimationFrame(j)}),(a,s)=>(X(),Y("div",{ref_key:"con",ref:x,class:"w-full h-full"},[Z("canvas",{ref_key:"canvas",ref:F,class:"block w-full h-full"},null,512)],512))}});export{ct as default};
