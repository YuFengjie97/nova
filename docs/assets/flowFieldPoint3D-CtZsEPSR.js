var j=Object.defineProperty;var q=(p,s,f)=>s in p?j(p,s,{enumerable:!0,configurable:!0,writable:!0,value:f}):p[s]=f;var k=(p,s,f)=>(q(p,typeof s!="symbol"?s+"":s,f),f);import{b as H}from"./simplex-noise-BtZ5wMFy.js";import{d as J,r as O,h as X,C as Y,G as N,L as tt,N as S,Q as et,aL as ot,K as st,R as nt,b as it,o as rt}from"./index-Ct6ceUkE.js";import{c as at}from"./chroma-DCKfFEcf.js";import{i as ct}from"./initThree-hbYHqMqB.js";import{p as lt}from"./dotTexture-NXlc0I5v.js";import"./_commonjsHelpers-BosuxZz1.js";import"./OrbitControls-BAA5edm8.js";import"./initStats-C5VNgmNK.js";const I=1e4,m=100,w=4,R=2,yt=J({__name:"flowFieldPoint3D",setup(p){const{random:s,PI:f,sin:D,cos:E,floor:z}=Math,G=at.scale(["#00b894","#0984e3","#6c5ce7","#fdcb6e","#e84393"]),T=H(),b=O(),t=new Float32Array(I*3),v=new Float32Array(I*3);let a=0,c=0,n=20;const F=[],y={};class U{constructor(i){k(this,"ind");k(this,"vel");this.ind=i,this.vel=new N(0,0,0)}getPos(){return{x:t[this.ind*3],y:t[this.ind*3+1],z:t[this.ind*3+2]}}edge(){const{x:i,y:d,z:h}=this.getPos();i<0&&(t[this.ind*3]=a),i>a&&(t[this.ind*3]=0),d<0&&(t[this.ind*3+1]=c),d>c&&(t[this.ind*3+1]=0),h<0&&(t[this.ind*3+2]=m),h>m&&(t[this.ind*3+2]=0)}update(i,d){this.edge();const[h,_,L]=G(i).gl();v[this.ind*3]=h,v[this.ind*3+1]=_,v[this.ind*3+2]=L,this.vel.add(d),this.vel.length()>R&&this.vel.setLength(R),t[this.ind*3]+=this.vel.x,t[this.ind*3+1]+=this.vel.y,t[this.ind*3+2]+=this.vel.z}}return X(()=>{const{width:$,height:i}=b.value.getBoundingClientRect();a=$/4,c=i/4,n=i/40;const{scene:d,camera:h,renderWrap:_,orbitControls:L}=ct(b.value,!1,!1,!1);h.position.set(a/2,c/2,m*2),h.lookAt(a/2,c/2,0),d.background=new Y(0);for(let e=-1;e*n<a+n;e+=1)for(let o=-1;o*n<c+n;o+=1)for(let r=-1;r*w<m+w;r+=1)y[`${e},${o},${r}`]={n:0,v:new N(0,0,0)};for(let e=0;e<I;e++){const o=s()*a,r=s()*c,l=s()*m;t[e*3]=o,t[e*3+1]=r,t[e*3+2]=l,F.push(new U(e))}const A=new tt;A.setAttribute("position",new S(t,3)),A.setAttribute("color",new S(v,3));const K=new et({size:1.5,map:new ot().load(lt),blending:st,transparent:!1,sizeAttenuation:!0,vertexColors:!0}),P=new nt(A,K);d.add(P);const Q=.05,V=.05,W=.01;let M=0;const Z=.01;_(()=>{M+=Z;let e=0;for(let o=-1;o*n<a+n;o+=1){e+=Q;let r=0;for(let l=-1;l*n<c+n;l+=1){r+=V;let x=0;for(let u=-1;u*w<m+w;u+=1){x+=W;const g=T(e,r,x,M)*.5+.5,B=4*f*g,C=R*.1*g;y[`${o},${l},${u}`].n=g,y[`${o},${l},${u}`].v.set(E(B)*C,D(B)*C,D(B)*C)}}}F.forEach(o=>{const{x:r,y:l,z:x}=o.getPos(),{n:u,v:g}=y[`${z(r/n)},${z(l/n)},${z(x/w)}`];o.update(u,g)}),P.geometry.attributes.position.needsUpdate=!0,P.geometry.attributes.color.needsUpdate=!0})()}),($,i)=>(rt(),it("div",{ref_key:"con",ref:b,class:"w-full h-full"},null,512))}});export{yt as default};
