import{P as T}from"./P5Con-DJd9bvJN.js";import{a as j}from"./p5.min-WfQBoNak.js";import{d as D,e as B,q as M,o as q}from"./index-CqfaNC88.js";function z(n,r){let e=!1;for(let s=0,o=n.length-1;s<n.length;s++)n[s].y>r[1]!=n[o].y>r[1]&&r[0]<(n[o].x-n[s].x)*(r[1]-n[s].y)/(n[o].y-n[s].y)+n[s].x&&(e=!e),o=s;return e}function F(n){let r=0,e,s,o,a;const u=n.length;for(e=0,s=u-1;e<u;s=e,e++)o=n[e],a=n[s],r+=o.x*a.y,r-=o.y*a.x;return r/=2,r}function I(n){let r=0,e=0,s,o,a,u,p;const m=n.length;for(s=0,o=m-1;s<m;o=s,s++)u=n[s],p=n[o],a=u.x*p.y-p.x*u.y,r+=(u.x+p.x)*a,e+=(u.y+p.y)*a;return a=F(n)*6,new j.Vector(r/a,e/a)}const G={class:"w-full h-full"},t=400,U=D({__name:"Tangram",setup(n){const{PI:r}=Math;let e,s,o,a,u,p,m,k,_,f=null;const w=r/180,c={},A=[{id:1,c:"#cd9670",center:[0,0],ps:[[0,0],[0,t],[t/2,t/2],[0,0]]},{id:2,c:"#f4444a",center:[0,0],ps:[[0,t],[t,t],[t/2,t/2],[0,t]]},{id:3,c:"#fd796d",center:[0,0],ps:[[0,0],[t/2,0],[t/4,t/4],[0,0]]},{id:4,c:"#e7d02d",center:[0,0],ps:[[t/2,0],[t/4,t/4],[t/2,t/2],[t*3/4,t/4],[t/2,0]]},{id:5,c:"#f9b02d",center:[0,0],ps:[[t*3/4,t/4],[t*3/4,t*3/4],[t/2,t/2],[t*3/4,t/4]]},{id:6,c:"#acc94a",center:[0,0],ps:[[t*3/4,t/4],[t,t/2],[t,t],[t*3/4,t*3/4],[t*3/4,t/4]]},{id:7,c:"#59afcb",center:[0,0],ps:[[t/2,0],[t,0],[t,t/2],[t/2,0]]}];class R{constructor(l,d,h){this.prePos=null,this.curPos=e.createVector(0,0),this.angle=0,this.id=l,this.color=d,this.points=h.map(g=>(g.set(g.x+a,g.y+u),g)),this.center=I(h);const{x:y,y:P}=this.center;console.log(this.id,y,P)}draw(){const{color:l,points:d,center:h,angle:y}=this,{x:P,y:g}=h;e.push(),e.translate(h.x,h.y),e.rotate(y),e.fill(l),e.stroke("#000"),e.strokeJoin(e.ROUND),e.strokeWeight(4),e.beginShape();for(let x=0,N=d.length;x<N;x++)e.vertex(d[x].x-P,d[x].y-g);e.endShape(),e.pop()}updatePoints(){if(this.center=I(this.points),f===this.id){this.prePos||(this.prePos=e.createVector(k,_)),this.curPos.set(p,m);const l=this.curPos.copy().sub(this.prePos);for(let d=0,h=this.points.length;d<h;d++)this.points[d].add(l);this.prePos.set(p,m)}else this.prePos=null}updateAngle(l){this.angle+=l?w:-w,console.log(this.angle)}}function b(){for(let i=0,l=A.length;i<l;i++){const{id:d,c:h,ps:y}=A[i];c[d]=new R(d,h,y.map(P=>e.createVector(...P)))}}function S(){for(const i in c)c.hasOwnProperty(i)&&(f===c[i].id&&(e.keyIsPressed&&e.key==="a"?c[f].updateAngle(!1):e.keyIsPressed&&e.key==="d"&&c[f].updateAngle(!0)),c[i].updatePoints(),c[i].draw())}function O(){p=e.pmouseX,m=e.pmouseY}function V(){const i=`
    鼠标左键摁住拖拽，
    键盘A/D大幅度旋转，
    键盘<-/->小幅度旋转
  `;e.fill("#000"),e.noStroke(),e.textSize(20),e.textWrap(e.WORD),e.textAlign(e.CENTER),e.text(i,s/2-250,10,500)}function C(i){s=i.width,o=i.height,a=s/2-t/2,u=o/2-t/2,e=i,b()}function W(){e.background("#8e44ad"),V(),O(),S()}function X(){k=e.mouseX,_=e.mouseY;for(const i in c){const l=String(8-Number(i));if(c.hasOwnProperty(l)&&z(c[l].points,[k,_])){f=c[l].id;break}}}function Y(){f=null}function E(){f&&(e.keyCode===e.LEFT_ARROW?c[f].updateAngle(!1):e.keyCode===e.RIGHT_ARROW&&c[f].updateAngle(!0))}return(i,l)=>(q(),B("div",G,[M(T,{setup:C,draw:W,"mouse-pressed":X,"mouse-released":Y,"key-pressed":E})]))}});export{U as default};
