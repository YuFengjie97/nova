var j=Object.defineProperty;var q=(p,s,f)=>s in p?j(p,s,{enumerable:!0,configurable:!0,writable:!0,value:f}):p[s]=f;var R=(p,s,f)=>(q(p,typeof s!="symbol"?s+"":s,f),f);import{b as H}from"./simplex-noise-CoJLqHZY.js";import{d as J,r as O,h as X,C as Y,G as N,L as tt,N as S,Q as et,aL as ot,K as st,R as nt,b as it,o as rt}from"./index-d425_xPA.js";import{c as at}from"./chroma-Jl_dHttK.js";import{i as ct}from"./initThree-I4Uv1MEu.js";import{p as lt}from"./dotTexture-mhtNNgxL.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./OrbitControls--t40w5p_.js";import"./initStats-1oN1fAIq.js";const yt=J({__name:"flowFieldPoint3D",setup(p){const{random:s,PI:f,sin:D,cos:E,floor:z}=Math,G=at.scale(["#00b894","#0984e3","#6c5ce7","#fdcb6e","#e84393"]),T=H(),b=O(),$=1e4,t=new Float32Array($*3),v=new Float32Array($*3);let a=0,c=0;const u=100;let n=20;const g=4,_=2,F=[],y={};class U{constructor(i){R(this,"ind");R(this,"vel");this.ind=i,this.vel=new N(0,0,0)}getPos(){return{x:t[this.ind*3],y:t[this.ind*3+1],z:t[this.ind*3+2]}}edge(){const{x:i,y:d,z:h}=this.getPos();i<0&&(t[this.ind*3]=a),i>a&&(t[this.ind*3]=0),d<0&&(t[this.ind*3+1]=c),d>c&&(t[this.ind*3+1]=0),h<0&&(t[this.ind*3+2]=u),h>u&&(t[this.ind*3+2]=0)}update(i,d){this.edge();const[h,P,L]=G(i).gl();v[this.ind*3]=h,v[this.ind*3+1]=P,v[this.ind*3+2]=L,this.vel.add(d),this.vel.length()>_&&this.vel.setLength(_),t[this.ind*3]+=this.vel.x,t[this.ind*3+1]+=this.vel.y,t[this.ind*3+2]+=this.vel.z}}return X(()=>{const{width:A,height:i}=b.value.getBoundingClientRect();a=A/4,c=i/4,n=i/40;const{scene:d,camera:h,renderWrap:P,orbitControls:L}=ct(b.value,!1,!1,!1);h.position.set(a/2,c/2,u*2),h.lookAt(a/2,c/2,0),d.background=new Y(0);for(let e=-1;e*n<a+n;e+=1)for(let o=-1;o*n<c+n;o+=1)for(let r=-1;r*g<u+g;r+=1)y[`${e},${o},${r}`]={n:0,v:new N(0,0,0)};for(let e=0;e<$;e++){const o=s()*a,r=s()*c,l=s()*u;t[e*3]=o,t[e*3+1]=r,t[e*3+2]=l,F.push(new U(e))}const B=new tt;B.setAttribute("position",new S(t,3)),B.setAttribute("color",new S(v,3));const K=new et({size:1.5,map:new ot().load(lt),blending:st,transparent:!1,sizeAttenuation:!0,vertexColors:!0}),C=new nt(B,K);d.add(C);const Q=.05,V=.05,W=.01;let M=0;const Z=.01;P(()=>{M+=Z;let e=0;for(let o=-1;o*n<a+n;o+=1){e+=Q;let r=0;for(let l=-1;l*n<c+n;l+=1){r+=V;let x=0;for(let m=-1;m*g<u+g;m+=1){x+=W;const w=T(e,r,x,M)*.5+.5,k=4*f*w,I=_*.1*w;y[`${o},${l},${m}`].n=w,y[`${o},${l},${m}`].v.set(E(k)*I,D(k)*I,D(k)*I)}}}F.forEach(o=>{const{x:r,y:l,z:x}=o.getPos(),{n:m,v:w}=y[`${z(r/n)},${z(l/n)},${z(x/g)}`];o.update(m,w)}),C.geometry.attributes.position.needsUpdate=!0,C.geometry.attributes.color.needsUpdate=!0})()}),(A,i)=>(rt(),it("div",{ref_key:"con",ref:b,class:"w-full h-full"},null,512))}});export{yt as default};
