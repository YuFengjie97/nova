import{a as B}from"./p5.min-WfQBoNak.js";import{A as M}from"./AudioController-DQ5RlVS_.js";import{P as b}from"./P5Con-DJd9bvJN.js";import{m as C}from"./audio-sugarCrush-1d8eZUIK.js";import{i as E,n as g}from"./p5bezier-DEnatsBd.js";import{d as S,r as v,e as L,q as w,y as V,o as D}from"./index-CqfaNC88.js";const N={class:"w-full h-full"},d=250,P=2,H=.6,T=60,K=S({__name:"MusicRect",setup(W){let r;function _(e){r=e}let p,i;const m=v(128),u=m.value/2,h=[];let a;class A{constructor(t,s){this.h=0,this.rectHeight=0,this.$p=t,this.pos=s}draw(t,s){const{$p:o,pos:{x:f,y:n},rectHeight:l}=this;o.fill(this.h,255,127),o.push(),o.rectMode(o.CENTER),o.noStroke(),o.translate(0,i/2);const c=a*.2;o.rect(f,n,a,this.rectHeight+P,c,c,c,c),o.pop()}update(t){this.updateH(t),this.updateHeight(t)}updateH(t){this.h=this.$p.map(t,0,d,0,255)}updateHeight(t){this.rectHeight=this.$p.map(t,0,d,0,i*H)}}function R(e){for(let t=0;t<u;t++)h.push(new A(e,new B.Vector(t*a,0)))}function k(e){for(let t=0;t<u;t++){const s=r.getAudioData()[t];h[t].update(s),h[t].draw(s,t)}}function x(e){e.push(),e.translate(0,i/2),e.noFill(),e.stroke("#fff"),e.strokeWeight(2);const t=[],s=[];r.getAudioData().forEach((o,f)=>{const n=f*a,l=e.map(o,0,d,0,i/2)*H+T;t.push([n,-l]),s.push([n,l])}),g(t),g(s),e.pop()}function y(e,t){p=e.width,i=e.height,a=p/u,e.frameRate(30),e.colorMode(e.HSB),e.noStroke(),R(e),t&&E(t)}function z(e){e.background("rgba(0, 0, 0, 1.)"),r&&(k(),x(e))}return(e,t)=>(D(),L("div",N,[w(M,{class:"absolute top-0 left-0 z-100","audio-src":V(C),"fft-size":m.value,onInitAudioAnalyser:_},null,8,["audio-src","fft-size"]),w(b,{setup:y,draw:z})]))}});export{K as default};
