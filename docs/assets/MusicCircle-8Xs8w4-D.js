var S=Object.defineProperty;var v=(i,a,n)=>a in i?S(i,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[a]=n;var e=(i,a,n)=>(v(i,typeof a!="symbol"?a+"":a,n),n);import{a as E}from"./p5.min--W7QciFv.js";import{P as V}from"./P5Con-jLXa2jFz.js";import{a as L,A as O}from"./AudioController-X57bS4OP.js";import{i as R,n as F}from"./p5bezier-kXiraHPG.js";import{b as H}from"./math-UzBzvN2k.js";import{d as N,r as T,o as W,b as j,l as g,u as q}from"./index-7fEuWlIe.js";const G={class:"w-full h-full"},$=N({__name:"MusicCircle",setup(i){const{PI:a,random:n,floor:x,min:P}=Math;let u,l;const p=T(64),d=p.value/2,m=[],c=[];let f;const _=250,h=100,b=.9,w="#5f27cd";class A{constructor(o,s,r){e(this,"$p");e(this,"angle");e(this,"basePos");e(this,"pos");e(this,"r",2);e(this,"audioIndex",0);e(this,"h",0);e(this,"count",0);this.$p=o,this.angle=s,this.basePos=E.Vector.fromAngle(s,P(u,l)/2*b),this.pos=this.basePos.copy(),this.audioIndex=r}draw(){const{$p:o,pos:{x:s,y:r},h:M,count:D}=this;o.noStroke(),o.fill((M+D)%255,255,127),o.circle(s,r,this.r*2)}update(o){this.pos=this.basePos.copy().mult(o),this.h=x(o*255),this.count++}}function I(t){f=t}function k(t){const o=H(d);for(let s=0;s<d;s++)m.push(new A(t,a*2/d*s,o()??0))}function y(){const t=f.getAudioData();c.length=0,m.forEach(o=>{const s=t[o.audioIndex],r=s<h?h:s;o.update(r/_),o.draw(),s>h&&c.push([o.pos.x,o.pos.y])})}function z(t){t.noFill(),t.stroke(w),t.strokeWeight(2),c.length>=10&&F(c,"CLOSE")}function C(t,o){u=t.width,l=t.height,t.colorMode(t.HSB),R(o),k(t)}function B(t){t.translate(u/2,l/2),t.background("rgba(0, 0, 0, 0.07)"),f&&(y(),z(t))}return(t,o)=>(W(),j("div",G,[g(O,{class:"absolute top-0 left-0 z-100","audio-src":q(L),"fft-size":p.value,onInitAudioAnalyser:I},null,8,["audio-src","fft-size"]),g(V,{setup:C,draw:B})]))}});export{$ as default};
