var T=Object.defineProperty;var $=(d,h,r)=>h in d?T(d,h,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[h]=r;var i=(d,h,r)=>($(d,typeof h!="symbol"?h+"":h,r),r);import{c as D}from"./chroma-Jl_dHttK.js";import{i as j}from"./initStats-1oN1fAIq.js";import{d as q,r as L,h as H,b as O,e as X,o as Y}from"./index-buY-64hZ.js";import"./_commonjsHelpers-4gQjN7DL.js";const Z=q({__name:"githubSnake",setup(d){const{random:h,PI:r,min:z,abs:g,sqrt:A,floor:l,ceil:V,round:G}=Math,E=D.scale(["#ebedf0","#27ae60"]),w="#8e44ad",n=40,o=2,v=10,y=4,I=5,b=5,m=L(),x=L();return H(()=>{const{width:f,height:u}=m.value.getBoundingClientRect();x.value.width=f,x.value.height=u;const e=x.value.getContext("2d"),{stats:R}=j(m.value),_=l(u/n),k=l(f/n);class B{constructor(t,s,a){i(this,"x",0);i(this,"y",0);i(this,"aliveLevel",0);this.x=t,this.y=s,this.aliveLevel=a}draw(){e.fillStyle=E(this.aliveLevel/b).css();const t=this.x*n,s=this.y*n;e.beginPath(),e.roundRect(t+o,s+o,n-2*o,n-2*o,v),e.fill()}}const p={};for(let c=0;c<_;c++)for(let t=0;t<k;t++){const s=new B(t,c,l(h()*b));p[`${t},${c}`]=s}class F{constructor(t,s,a){i(this,"level",0);i(this,"x",0);i(this,"y",0);i(this,"xInc",0);i(this,"yInc",0);this.x=t,this.y=s,this.level=a}updatateInc(t,s){this.xInc=t,this.yInc=s}update(){this.x+=this.xInc*y,this.y+=this.yInc*y}draw(){e.fillStyle=w;const t=.4+(I-this.level)/I*.4,s=n*t,a=n*t,N=this.x+(1-t)/2*n,P=this.y+(1-t)/2*n;e.beginPath(),e.roundRect(N,P,s,a,v),e.fill()}}class M{constructor(){i(this,"xInd",l(k/2));i(this,"yInd",l(_/2));i(this,"x",this.xInd*n);i(this,"y",this.yInd*n);i(this,"xftInd",this.xInd-2);i(this,"yftInd",this.yInd);i(this,"xdtInd",this.xInd-1);i(this,"ydtInd",this.yInd);i(this,"xdt",this.xdtInd*n);i(this,"ydt",this.ydtInd*n);i(this,"xInc",-1);i(this,"yInc",0);i(this,"done",!1);i(this,"tails",[]);i(this,"history",[{xInc:this.xInc,yInc:this.yInc}]);for(let t=0;t<I;t++){const s=new F(this.x,this.y,t);this.tails.push(s)}}updateNextDir(){let t=this.xftInd-this.xInd,s=this.yftInd-this.yInd;t=t>0?1:t===0?0:-1,s=s>0?1:s===0?0:-1,t!==0&&s!==0&&(h()<.5?t=0:s=0),this.xInc=t,this.yInc=s,this.xdtInd=this.xInd+t,this.ydtInd=this.yInd+s,this.xdt=this.xdtInd*n,this.ydt=this.ydtInd*n}updateFinTar(){const t=Object.values(p).filter(a=>a.aliveLevel!==0);if(t.length===0){this.done=!0;return}const s=t[l(h()*t.length)];this.xftInd=s.x,this.yftInd=s.y}eat(){p[`${this.xInd},${this.yInd}`].aliveLevel=0,this.xftInd===this.xInd&&this.yftInd===this.yInd&&(this.updateFinTar(),this.updateNextDir()),this.updateNextDir(),this.updateHistory()}updateHistory(){this.history.length===I+1&&this.history.pop(),this.history.unshift({xInc:this.xInc,yInc:this.yInc}),this.tails.forEach((t,s)=>{if(s<this.history.length-1){const a=this.history[s+1];t.updatateInc(a.xInc,a.yInc)}})}update(){this.done||(this.x+=this.xInc*y,this.y+=this.yInc*y,this.xInd=l(this.x/n),this.yInd=l(this.y/n),g(this.xdt-this.x)<y&&g(this.ydt-this.y)<y&&this.eat(),this.tails.forEach(t=>{t.update()}))}draw(){e.fillStyle=w,e.beginPath(),e.roundRect(this.x+o,this.y+o,n-2*o,n-2*o,v),e.fill(),this.tails.forEach(t=>t.draw())}}const S=new M;function C(){R.update(),e.fillStyle="#fff",e.fillRect(0,0,f,u),Object.values(p).forEach(c=>c.draw()),S.update(),S.draw(),requestAnimationFrame(C)}C()}),(f,u)=>(Y(),O("div",{ref_key:"con",ref:m,class:"w-full h-full"},[X("canvas",{ref_key:"canvas",ref:x,class:"block w-full h-full"},null,512)],512))}});export{Z as default};
