var b=Object.defineProperty;var C=(r,o,a)=>o in r?b(r,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[o]=a;var u=(r,o,a)=>(C(r,typeof o!="symbol"?o+"":o,a),a);import{a as E}from"./p5.min-fQewtR-G.js";import{A as S}from"./AudioController-W8og8kz3.js";import{P as v}from"./P5Con-CEFicUcn.js";import{m as L}from"./audio-sugarCrush-1d8eZUIK.js";import{i as V,n as _}from"./p5bezier-EB3vEi2U.js";import{d as D,r as N,e as P,q as A,A as T,o as W}from"./index-Da-WdZGY.js";const q={class:"w-full h-full"},g=250,F=2,R=.6,I=60,X=D({__name:"MusicRect",setup(r){let o;function a(e){o=e}let w,n;const H=N(128),l=H.value/2,d=[];let c;class k{constructor(t,i){u(this,"$p");u(this,"pos");u(this,"h",0);u(this,"rectHeight",0);this.$p=t,this.pos=i}draw(t,i){const{$p:s,pos:{x:p,y:h},rectHeight:m}=this;s.fill(this.h,255,127),s.push(),s.rectMode(s.CENTER),s.noStroke(),s.translate(0,n/2);const f=c*.2;s.rect(p,h,c,this.rectHeight+F,f,f,f,f),s.pop()}update(t){this.updateH(t),this.updateHeight(t)}updateH(t){this.h=this.$p.map(t,0,g,0,255)}updateHeight(t){this.rectHeight=this.$p.map(t,0,g,0,n*R)}}function x(e){for(let t=0;t<l;t++)d.push(new k(e,new E.Vector(t*c,0)))}function z(e){for(let t=0;t<l;t++){const i=o.getAudioData()[t];d[t].update(i),d[t].draw(i,t)}}function y(e){e.push(),e.translate(0,n/2),e.noFill(),e.stroke("#fff"),e.strokeWeight(2);const t=[],i=[];o.getAudioData().forEach((s,p)=>{const h=p*c,m=e.map(s,0,g,0,n/2)*R+I;t.push([h,-m]),i.push([h,m])}),_(t),_(i),e.pop()}function B(e,t){w=e.width,n=e.height,c=w/l,e.frameRate(30),e.colorMode(e.HSB),e.noStroke(),x(e),t&&V(t)}function M(e){e.background("rgba(0, 0, 0, 1.)"),o&&(z(),y(e))}return(e,t)=>(W(),P("div",q,[A(S,{class:"absolute top-0 left-0 z-100","audio-src":T(L),"fft-size":H.value,onInitAudioAnalyser:a},null,8,["audio-src","fft-size"]),A(v,{setup:B,draw:M})]))}});export{X as default};
