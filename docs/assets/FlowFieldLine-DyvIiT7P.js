import{C as V}from"./Card-D76Pik8w.js";import{f as p}from"./fabric-7ZMa6wlx.js";import{n as E}from"./noise-CqzBSU_F.js";import"./p5.min-WfQBoNak.js";import{d as H,r as C,j as O,e as R,q as T,s as W,f as P,o as X}from"./index-CqfaNC88.js";const Y={class:"flowFieldLine"},$=H({__name:"FlowFieldLine",setup(G){const{floor:v,sin:b,cos:B,PI:m,random:h}=Math,w=C(),x=C();let s=0,n=0,f=0,y=0,r=40,a=null,k=.3,z=.3,I=8e-4,F=0,A=360;const d=[];let _=100;const u=[];O(()=>{j(),q(),L(),g()});function j(){var i;let{width:t,height:e}=(i=w.value)==null?void 0:i.getBoundingClientRect();s=t,n=e,f=s/r,y=n/r,a=new p.fabric.StaticCanvas(x.value,{width:s,height:n,fill:"rgba(255, 255, 255, 0.6)"})}function q(){for(let t=0;t<s;t+=r)for(let e=0;e<n;e+=r)d.push(new S({x:t,y:e},r))}function D(){let t=0;for(let e=0;e<y;e++){t+=k,F+=I;let i=0;for(let l=0;l<f;l++){i+=z;let o=E(t,i,F)*A,c=l+e*f;c>0&&c<d.length&&d[c].update(o)}}}function L(){let t=0;for(;t<_;)u.push(new N({x:h()*s,y:h()*n},"red")),t++}function M(){let t=0;for(;t<_;){let{top:e,left:i}=u[t].circle,l=v(e/r),o=v(i/r),c=l*f+o;c>=0&&c<d.length?u[t].updatePos(d[l*f+o].vec):u[t].updatePos({vx:1,vy:1}),t++}}function g(){D(),M(),a==null||a.renderAll(),p.fabric.util.requestAnimFrame(g)}class N{constructor(e,i){let{x:l,y:o}=e;this.color=i,this.circle=new p.fabric.Circle({top:o,left:l,fill:"red",radius:1,originX:"center",originY:"center"}),a==null||a.add(this.circle)}updatePos(e){let{top:i,left:l}=this.circle;(l<=0||l>=s||i<=0||i>=n)&&(this.circle.left=h()*s,this.circle.top=h()*n);let{vx:o,vy:c}=e;this.circle.left+=o,this.circle.top+=c}}class S{constructor(e,i){this.angle=45,this.position=e,this.size=i,this.vec={vx:0,vy:0}}update(e){this.angle=e;let i=B(e/180*m)*3,l=b(e/180*m)*3;this.vec.vx=i,this.vec.vy=l}}return(t,e)=>(X(),R("div",Y,[T(V,{class:"card"},{default:W(()=>[P("div",{class:"con",ref_key:"con",ref:w},[P("canvas",{ref_key:"canvasDom",ref:x},null,512)],512)]),_:1})]))}});export{$ as default};
