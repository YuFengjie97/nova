var Q=Object.defineProperty;var X=(e,n,u)=>n in e?Q(e,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[n]=u;var m=(e,n,u)=>(X(e,typeof n!="symbol"?n+"":n,u),u);import{d as F,b as z,h as Y,c as W,a as v,y as b,z as x,x as Z,o as G,_ as I,e as O,u as L}from"./index.487d7da2.js";import{p as g}from"./p5.min.83b8630c.js";import{P as $}from"./P5Con.42c03705.js";class ee{constructor(n,u=512){m(this,"dataArray");m(this,"analyser");const f=window.AudioContext,l=new f,i=l.createAnalyser();i.fftSize=u,this.analyser=i,l.createMediaElementSource(n).connect(i),i.connect(l.destination);const s=i.frequencyBinCount;this.dataArray=new Uint8Array(s)}getAudioData(){return this.analyser.getByteFrequencyData(this.dataArray),this.dataArray}}const te="/nova/assets/houtui.4a03eb37.svg",oe="/nova/assets/bofang.8674e47a.svg",ae="/nova/assets/zanting.a3da3082.svg",ne="/nova/assets/tingzhi.b8a7fdb5.svg",se="/nova/assets/kuaijin.855f2fcd.svg",re={class:"con"},ie={class:"houtui",src:te},ce={class:"tingzhi",src:ne},le={class:"kuaijin",src:se},ue=F({__name:"AudioController",props:{showStop:{type:Boolean,default:!1},showForward:{type:Boolean,default:!1},showBackward:{type:Boolean,default:!1},audioSrc:null,fftSize:{default:512}},emits:["backward","play","pause","stop","forward","initAudioAnalyser"],setup(e,{emit:n}){const u=e;let f;const l=z(!1);function i(){var t;l.value=!0,(t=s.value)==null||t.play(),f||(f=new ee(s.value,u.fftSize),n("initAudioAnalyser",f))}function c(){var t;l.value=!1,(t=s.value)==null||t.pause()}const s=z(),r=z(!1);return Y(()=>{s.value&&(s.value.src=u.audioSrc,s.value.oncanplay=function(){r.value=!0,console.log("audio load ok")})}),(t,H)=>(G(),W("div",re,[v("div",{class:Z(["audioControlCon",{disable:!r.value}])},[b(v("img",ie,null,512),[[x,e.showBackward]]),b(v("img",{class:"bofang",onClick:i,src:oe},null,512),[[x,!l.value]]),b(v("img",{class:"zanting",onClick:c,src:ae},null,512),[[x,l.value]]),b(v("img",ce,null,512),[[x,e.showStop]]),b(v("img",le,null,512),[[x,e.showForward]])],2),v("audio",{ref_key:"audioDom",ref:s,loop:""},null,512)]))}});const de=I(ue,[["__scopeId","data-v-e6ddae72"]]),fe="/nova/assets/audio1.c4ef9dc4.mp3",he=[.2,.1,.05,.04,.02,.01,.008,.002,.001,5e-4,1e-4];let w,d,y,S,B,R,P,A,k;function pe(e,n=!1){if(w=e,d=w.drawingContext,g&&e instanceof g.Graphics)B=!0,y=d.constructor.name==="WebGLRenderingContext"?3:2,R=w.beginShape,P=w.vertex,A=w.vertex,k=w.endShape;else if(g&&e instanceof g.Renderer||e.drawingContext)!g||g&&!(e instanceof g.Renderer)?(window.console.warn("[p5.bezier] Support for non-p5 canvas is not tested."),y=e.isP3D?3:2):y=d.constructor.name==="WebGLRenderingContext"?3:2,B=!1,y=d.constructor.name==="WebGLRenderingContext"?3:2,R=d.beginPath.bind(d),P=d.moveTo.bind(d),A=d.lineTo.bind(d),k=d.closePath.bind(d);else throw new Error("[p5.bezier] Canvas is not supported.");S=n}function N(e,n="OPEN",u=6){if(S&&!Array.isArray(e))throw new Error(`[p5.bezier] newBezier() function expects an array, got ${typeof e}.`);const f=he[u];if(y!==0){if(S){for(let c of e)if(!Array.isArray(e)||c.length!==y)throw new Error("[p5.bezier] One or more points in the array are not input correctly.")}n==="CLOSE"&&e.push(e[0]);let i=e.length-1;if(R(),P(...e[0]),y===2){let c,s,r,t;for(r=0;r<=1;r+=f){for(c=0,s=0,t=0;t<=i;t++)c+=p(i)/(p(t)*p(i-t))*Math.pow(1-r,i-t)*Math.pow(r,t)*e[t][0],s+=p(i)/(p(t)*p(i-t))*Math.pow(1-r,i-t)*Math.pow(r,t)*e[t][1];A(c,s)}A(...e.slice(-1)[0])}else if(y===3){let c=[0,0,0],s,r,t;for(s=0;s<=1;s+=f){for(c=[0,0,0],r=0;r<=i;r++)for(t=0;t<3;t++)c[t]+=p(i)/(p(r)*p(i-r))*Math.pow(1-s,i-r)*Math.pow(s,r)*e[r][t];A(...c)}A(...e.slice(-1)[0])}if(B)k(n);else if(n==="CLOSE")k();else if(S&&n!=="OPEN")throw new Error("[p5.bezier] Close type error. A bezier curve can only be either OPEN or CLOSE.");_e();return}}function p(e){return e>1?e*p(e-1):1}function _e(){w._doFill&&d.fill(),w._doStroke&&d.stroke()}const ge={class:"viewCon"},we=F({__name:"MusicRect",setup(e){let n;function u(a){n=a}let f,l;const i=z(128),c=250,s=i.value/2,r=[];let t,H=2,D=.6,T=60;class V{constructor(o,_){m(this,"$p");m(this,"pos");m(this,"h",0);m(this,"rectHeight",0);this.$p=o,this.pos=_}draw(o,_){let{$p:h,pos:{x:E,y:C},rectHeight:M}=this;h.fill(this.h,255,127),h.push(),h.rectMode(h.CENTER),h.noStroke(),h.translate(0,l/2),h.rect(E,C,t,this.rectHeight+H),h.pop()}update(o){this.updateH(o),this.updateHeight(o)}updateH(o){this.h=this.$p.map(o,0,c,0,255)}updateHeight(o){this.rectHeight=this.$p.map(o,0,c,0,l*D)}}function j(a){for(let o=0;o<s;o++)r.push(new V(a,new g.Vector(o*t,0)))}function q(a){for(let o=0;o<s;o++){let _=n.getAudioData()[o];r[o].update(_),r[o].draw(_,o)}}function U(a){a.push(),a.translate(0,l/2),a.noFill(),a.stroke("#fff"),a.strokeWeight(2);let o=[],_=[];n.getAudioData().forEach((h,E)=>{let C=E*t,M=a.map(h,0,c,0,l/2)*D+T;o.push([C,-M]),_.push([C,M])}),N(o),N(_),a.pop()}function J(a,o){f=a.width,l=a.height,t=f/s,a.frameRate(30),a.colorMode(a.HSB),a.noStroke(),j(a),o&&pe(o)}function K(a){a.background("#2d3436"),n&&(q(),U(a))}return(a,o)=>(G(),W("div",ge,[O(de,{class:"ac","audio-src":L(fe),"fft-size":i.value,onInitAudioAnalyser:u},null,8,["audio-src","fft-size"]),O($,{setup:J,draw:K})]))}});const be=I(we,[["__scopeId","data-v-37a29c0a"]]);export{be as default};
