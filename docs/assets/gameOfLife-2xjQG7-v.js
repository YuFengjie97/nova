import{d as S,r as y,j as T,H as B,C as F,e as I,f as M,o as R,_ as q}from"./index-CqfaNC88.js";const O=S({__name:"gameOfLife",setup(P){const{floor:h}=Math,u=y(),o=y();let g=0;return T(async()=>{var _,b,x;const{width:a,height:l}=u.value.getBoundingClientRect();o.value.width=a,o.value.height=l;const f=o.value.getContext("2d"),{stats:N}=B(u.value),s=20,d=h(l/s),v=h(a/s),w=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],c={};function k(){const i=document.createElement("canvas");i.width=a,i.height=l;const e=i.getContext("2d");e.lineWidth=.5,e.strokeStyle="#000";for(let t=0;t<v;t+=1)e.beginPath(),e.moveTo(t*s,0),e.lineTo(t*s,l),e.stroke();for(let t=0;t<d;t+=1)e.beginPath(),e.moveTo(0,t*s),e.lineTo(a,t*s),e.stroke();return i}const C=k();class ${constructor(e,t,n){this.neighborNum=0,this.x=e,this.y=t,this.isAlive=n}updateNeighborNum(){this.neighborNum=0,w.forEach(([e,t])=>{const n=this.x+e,r=this.y+t;n<0||n>=v||r<0||r>=d||c[`${n},${r}`].isAlive&&(this.neighborNum+=1)})}update(){this.updateNeighborNum(),this.isAlive&&this.neighborNum<2&&(this.isAlive=!1),this.isAlive&&this.neighborNum>=2&&this.neighborNum<=3&&(this.isAlive=!0),this.isAlive&&this.neighborNum>3&&(this.isAlive=!1),!this.isAlive&&this.neighborNum===3&&(this.isAlive=!0)}draw(){this.isAlive?f.fillStyle="#000":f.fillStyle="#fff",f.fillRect(this.x*s,this.y*s,s,s)}}function E(){for(let i=0;i<v;i++)for(let e=0;e<d;e++){const t=new $(i,e,!1);c[`${i},${e}`]=t,t.isAlive=!1}}E(),(_=o.value)==null||_.addEventListener("mousedown",()=>!0),(b=o.value)==null||b.addEventListener("mouseup",()=>!1),(x=o.value)==null||x.addEventListener("click",i=>{const{clientX:e,clientY:t}=i,n=h(e/s),r=h(t/s);c[`${n},${r}`].isAlive=!c[`${n},${r}`].isAlive});let m=!1;document.addEventListener("keyup",i=>{i.code==="Space"&&(m=!m)});const L=1e3/60;let p=0;function A(i){if(f.clearRect(0,0,a,l),f.drawImage(C,0,0,a,l),i-p>L){N.update();for(const e in c)m&&c[e].update(),c[e].draw();p=i}g=requestAnimationFrame(A)}requestAnimationFrame(A)}),F(()=>{cancelAnimationFrame(g)}),(a,l)=>(R(),I("div",{ref_key:"con",ref:u,class:"w-full h-full"},[M("canvas",{ref_key:"canvas",ref:o,class:"block w-full h-full"},null,512)],512))}}),z=q(O,[["__scopeId","data-v-cb853f4d"]]);export{z as default};
