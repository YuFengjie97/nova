var T=Object.defineProperty;var $=(d,h,r)=>h in d?T(d,h,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[h]=r;var i=(d,h,r)=>($(d,typeof h!="symbol"?h+"":h,r),r);import{c as D}from"./chroma-wKDBd-uV.js";import{i as j}from"./initStats-0J0VmoiC.js";import{d as q,r as L,h as H,o as O,b as X,e as Y}from"./index-w3o6Dwr7.js";const W=q({__name:"githubSnake",setup(d){const{random:h,PI:r,min:z,abs:w,sqrt:A,floor:o,ceil:V,round:G}=Math,E=D.scale(["#ebedf0","#27ae60"]),S="#8e44ad",n=40,a=2,v=10,I=4,y=5,b=5,g=L(),x=L();return H(()=>{const{width:f,height:u}=g.value.getBoundingClientRect();x.value.width=f,x.value.height=u;const e=x.value.getContext("2d"),{stats:R}=j(g.value),_=o(u/n),k=o(f/n);class B{constructor(t,s,c){i(this,"x",0);i(this,"y",0);i(this,"aliveLevel",0);this.x=t,this.y=s,this.aliveLevel=c}draw(){e.fillStyle=E(this.aliveLevel/b).css();const t=this.x*n,s=this.y*n;e.beginPath(),e.roundRect(t+a,s+a,n-2*a,n-2*a,v),e.fill()}}const p={};for(let l=0;l<_;l++)for(let t=0;t<k;t++){const s=new B(t,l,o(h()*b));p[`${t},${l}`]=s}class F{constructor(t,s,c){i(this,"level",0);i(this,"x",0);i(this,"y",0);i(this,"xInc",0);i(this,"yInc",0);this.x=t,this.y=s,this.level=c}updatateInc(t,s){this.xInc=t,this.yInc=s}update(){this.x+=this.xInc*I,this.y+=this.yInc*I}draw(){e.fillStyle=S;const t=.4+(y-this.level)/y*.4,s=n*t,c=n*t,N=this.x+(1-t)/2*n,P=this.y+(1-t)/2*n;e.beginPath(),e.roundRect(N,P,s,c,v),e.fill()}toString(){console.log(this.xInc,this.yInc)}}class M{constructor(){i(this,"xInd",o(k/2));i(this,"yInd",o(_/2));i(this,"x",this.xInd*n);i(this,"y",this.yInd*n);i(this,"xftInd",this.xInd-2);i(this,"yftInd",this.yInd);i(this,"xdtInd",this.xInd-1);i(this,"ydtInd",this.yInd);i(this,"xdt",this.xdtInd*n);i(this,"ydt",this.ydtInd*n);i(this,"xInc",-1);i(this,"yInc",0);i(this,"done",!1);i(this,"tails",[]);i(this,"history",[{xInc:this.xInc,yInc:this.yInc}]);for(let t=0;t<y;t++){const s=new F(this.x,this.y,t);this.tails.push(s)}}updateNextDir(){let t=this.xftInd-this.xInd,s=this.yftInd-this.yInd;t=t>0?1:t===0?0:-1,s=s>0?1:s===0?0:-1,t!==0&&s!==0&&(h()<.5?t=0:s=0),this.xInc=t,this.yInc=s,this.xdtInd=this.xInd+t,this.ydtInd=this.yInd+s,this.xdt=this.xdtInd*n,this.ydt=this.ydtInd*n}updateFinTar(){const t=Object.values(p).filter(c=>c.aliveLevel!==0);if(t.length===0){this.done=!0;return}const s=t[o(h()*t.length)];this.xftInd=s.x,this.yftInd=s.y}eat(){p[`${this.xInd},${this.yInd}`].aliveLevel=0,this.xftInd===this.xInd&&this.yftInd===this.yInd&&(this.updateFinTar(),this.updateNextDir()),this.updateNextDir(),this.updateHistory()}updateHistory(){this.history.length===y+1&&this.history.pop(),this.history.unshift({xInc:this.xInc,yInc:this.yInc}),this.tails.forEach((t,s)=>{if(s<this.history.length-1){const c=this.history[s+1];t.updatateInc(c.xInc,c.yInc)}})}update(){this.done||(this.x+=this.xInc*I,this.y+=this.yInc*I,this.xInd=o(this.x/n),this.yInd=o(this.y/n),w(this.xdt-this.x)<I&&w(this.ydt-this.y)<I&&this.eat(),this.toString(),this.tails.forEach(t=>{t.update(),t.toString()}))}draw(){e.fillStyle=S,e.beginPath(),e.roundRect(this.x+a,this.y+a,n-2*a,n-2*a,v),e.fill(),this.tails.forEach(t=>t.draw())}toString(){console.log(this.xInd,this.yInd,this.xInc,this.yInc)}}const m=new M;function C(){R.update(),e.fillStyle="#fff",e.fillRect(0,0,f,u),Object.values(p).forEach(l=>l.draw()),m.update(),m.toString(),m.draw(),requestAnimationFrame(C)}C()}),(f,u)=>(O(),X("div",{ref_key:"con",ref:g,class:"w-full h-full"},[Y("canvas",{ref_key:"canvas",ref:x,class:"block w-full h-full"},null,512)],512))}});export{W as default};
