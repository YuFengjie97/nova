var O=Object.defineProperty;var R=(p,o,c)=>o in p?O(p,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):p[o]=c;var h=(p,o,c)=>(R(p,typeof o!="symbol"?o+"":o,c),c);import{C as T}from"./Card-HKgYv-yn.js";import{f as x}from"./fabric-B5mOjS7x.js";import{n as W}from"./noise-CqzBSU_F.js";import"./p5.min-B-rUit5K.js";import{d as X,r as k,h as Y,b as G,k as J,l as K,o as Q,e as z}from"./index-BkxFcAok.js";import"./_commonjsHelpers-BosuxZz1.js";const U={class:"flowFieldLine"},ce=X({__name:"FlowFieldLine",setup(p){const{ceil:o,floor:c,sin:B,cos:I,PI:y,random:m}=Math,F=k(),_=k();let r=0,a=0,u=0,g=0,f=40,d=null,A=.3,D=.3,L=8e-4,C=0,M=360;const v=[];let P=100;const w=[];Y(()=>{N(),S(),j(),b()});function N(){var i;let{width:t,height:e}=(i=F.value)==null?void 0:i.getBoundingClientRect();r=t,a=e,u=r/f,g=a/f,d=new x.fabric.StaticCanvas(_.value,{width:r,height:a,fill:"rgba(255, 255, 255, 0.6)"})}function S(){for(let t=0;t<r;t+=f)for(let e=0;e<a;e+=f)v.push(new H({x:t,y:e},f))}function V(){let t=0;for(let e=0;e<g;e++){t+=A,C+=L;let i=0;for(let l=0;l<u;l++){i+=D;let n=W(t,i,C)*M,s=l+e*u;s>0&&s<v.length&&v[s].update(n)}}}function j(){let t=0;for(;t<P;)w.push(new E({x:m()*r,y:m()*a},"red")),t++}function q(){let t=0;for(;t<P;){let{top:e,left:i}=w[t].circle,l=c(e/f),n=c(i/f),s=l*u+n;s>=0&&s<v.length?w[t].updatePos(v[l*u+n].vec):w[t].updatePos({vx:1,vy:1}),t++}}function b(){V(),q(),d==null||d.renderAll(),x.fabric.util.requestAnimFrame(b)}class E{constructor(e,i){h(this,"color");h(this,"circle");let{x:l,y:n}=e;this.color=i,this.circle=new x.fabric.Circle({top:n,left:l,fill:"red",radius:1,originX:"center",originY:"center"}),d==null||d.add(this.circle)}updatePos(e){let{top:i,left:l}=this.circle;(l<=0||l>=r||i<=0||i>=a)&&(this.circle.left=m()*r,this.circle.top=m()*a);let{vx:n,vy:s}=e;this.circle.left+=n,this.circle.top+=s}}class H{constructor(e,i){h(this,"position");h(this,"size");h(this,"angle",45);h(this,"vec");this.position=e,this.size=i,this.vec={vx:0,vy:0}}update(e){this.angle=e;let i=I(e/180*y)*3,l=B(e/180*y)*3;this.vec.vx=i,this.vec.vy=l}}return(t,e)=>(Q(),G("div",U,[J(T,{class:"card"},{default:K(()=>[z("div",{class:"con",ref_key:"con",ref:F},[z("canvas",{ref_key:"canvasDom",ref:_},null,512)],512)]),_:1})]))}});export{ce as default};
