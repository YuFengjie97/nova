import{D as G}from"./index-WM3n2avM.js";import{g as H}from"./index-FSCrshNh.js";import{d as L,r as x,h as A,V as d,o as w,b as k,e as B,u as X,F as J,j as K,n as O,_ as Q}from"./index-q23ke8Ly.js";import"./p5.min-B7RTaEG1.js";import{g as U}from"./math-MiJUWhnP.js";import{p as Y}from"./disco_communism-NN-qA4tW.js";const Z={class:"w-full h-full flex justify-center bg-#c23616 overflow-hidden"},tt=["src"],ot=["src"],et=L({__name:"crushPic",setup(nt){const{random:g,sqrt:I,floor:P,ceil:T}=Math,z=30,C=x([]),S=x(),_=x(),i=x([]),u=[];function V(){return new Promise(a=>{_.value.onload=()=>{const{width:l,height:p}=_.value.getBoundingClientRect();a({width:l,height:p})}})}return A(async()=>{if(!S.value)return;const{width:a,height:l}=await V(),p=new d(a/2,l/2);v(),setTimeout(()=>{j()},1e3);function v(){const n=[],s=P(I(z)),o=T(z/s),r=a/s,f=l/o;for(let t=0;t<s;t+=1)for(let e=0;e<o;e+=1){const m=new d((t+g())*r,(e+g())*f);n.push(m)}const c=G.from(n.map(t=>[t.x,t.y])).triangles;for(let t=0;t<c.length;t+=3){const e=n[c[t]],m=n[c[t+1]],b=n[c[t+2]],D=`clip-path: polygon(${e.x}px ${e.y}px,${m.x}px ${m.y}px,${b.x}px ${b.y}px)`;C.value.push(D);const $=U(e,m,b).sub(p),F=$.length()/new d(a/2,l/2).length(),y=new d().copy($.normalize()).multiply(new d(.3,.3)),M=y.x*a/2,N=y.y*l/2,R=F*-200,E=g()>.8,W=E?y.x*200:0,q=E?y.y*200:0;u.push({x:M,y:N,z:R,rx:W,ry:q})}}function j(){const n=H.timeline({repeat:-1});u.forEach((s,o)=>{const{x:r,y:f,z:h,rx:c,ry:t}=s,e=i.value[o];n.to(e,{x:r,y:f,z:h,rotateX:c,rotateY:t,duration:1,ease:"bounce.out"},"<")}),u.forEach((s,o)=>{const{x:r,y:f,z:h,rx:c,ry:t}=s,e=i.value[o];n.to(e,{x:r,y:f,z:h,rotateX:c,rotateY:t,duration:1},o===0?">":"<")}),u.forEach((s,o)=>{const r=i.value[o];n.to(r,{x:0,y:0,z:0,rotateX:0,rotateY:0,duration:.3,ease:"bounce.out"},">")}),u.forEach((s,o)=>{const r=i.value[o];n.to(r,{x:0,y:0,z:0,rotateX:0,rotateY:0,duration:1},o===0?">":"<")})}}),(a,l)=>(w(),k("div",Z,[B("div",{ref_key:"picCon",ref:S,class:"pic-con relative h-full"},[B("img",{ref_key:"img",ref:_,class:"relative z--1 invisible block h-full",src:X(Y)},null,8,tt),(w(!0),k(J,null,K(C.value,(p,v)=>(w(),k("img",{ref_for:!0,ref_key:"imgs",ref:i,key:v,style:O([p]),class:"absolute top-0 left-0 block h-full",src:X(Y)},null,12,ot))),128))],512)]))}}),pt=Q(et,[["__scopeId","data-v-b01db4b7"]]);export{pt as default};
