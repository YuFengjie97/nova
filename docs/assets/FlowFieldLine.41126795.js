var O=Object.defineProperty;var R=(p,o,c)=>o in p?O(p,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):p[o]=c;var d=(p,o,c)=>(R(p,typeof o!="symbol"?o+"":o,c),c);import{C as T}from"./Card.97eb83b0.js";import{f as x}from"./fabric.98dee396.js";import{n as W}from"./p5.min.46365519.js";import{d as X,b as z,h as Y,c as G,e as J,w as K,o as Q,a as B,_ as U}from"./index.a132610e.js";const Z={class:"flowFieldLine"},$=X({__name:"FlowFieldLine",setup(p){const{ceil:o,floor:c,sin:I,cos:k,PI:m,random:_}=Math,F=z(),y=z();let s=0,r=0,h=0,g=0,a=40,f=null,L=.3,A=.3,D=8e-4,b=0,M=360;const v=[];let C=100;const w=[];Y(()=>{N(),S(),j(),P()});function N(){var l;let{width:t,height:e}=(l=F.value)==null?void 0:l.getBoundingClientRect();s=t,r=e,h=s/a,g=r/a,f=new x.fabric.StaticCanvas(y.value,{width:s,height:r,fill:"rgba(255, 255, 255, 0.6)"})}function S(){for(let t=0;t<s;t+=a)for(let e=0;e<r;e+=a)v.push(new H({x:t,y:e},a))}function V(){let t=0;for(let e=0;e<g;e++){t+=L,b+=D;let l=0;for(let i=0;i<h;i++){l+=A;let n=W(t,l,b)*M,u=i+e*h;v[u].update(n)}}}function j(){let t=0;for(;t<C;)w.push(new E({x:_()*s,y:_()*r},"red")),t++}function q(){let t=0;for(;t<C;){let{top:e,left:l}=w[t].circle,i=c(e/a),n=c(l/a),u=i*h+n;u>=0&&u<v.length?w[t].updatePos(v[i*h+n].vec):w[t].updatePos({vx:1,vy:1}),t++}}function P(){V(),q(),f==null||f.renderAll(),x.fabric.util.requestAnimFrame(P)}class E{constructor(e,l){d(this,"color");d(this,"circle");let{x:i,y:n}=e;this.color=l,this.circle=new x.fabric.Circle({top:n,left:i,fill:"red",radius:1,originX:"center",originY:"center"}),f==null||f.add(this.circle)}updatePos(e){let{top:l,left:i}=this.circle;(i<=0||i>=s||l<=0||l>=r)&&(this.circle.left=_()*s,this.circle.top=_()*r);let{vx:n,vy:u}=e;this.circle.left+=n,this.circle.top+=u}}class H{constructor(e,l){d(this,"position");d(this,"size");d(this,"angle",45);d(this,"vec");this.position=e,this.size=l,this.vec={vx:0,vy:0}}update(e){this.angle=e;let l=k(e/180*m)*3,i=I(e/180*m)*3;this.vec.vx=l,this.vec.vy=i}}return(t,e)=>(Q(),G("div",Z,[J(T,{bgColor:"#00cec9"},{default:K(()=>[B("div",{class:"con",ref_key:"con",ref:F},[B("canvas",{ref_key:"canvasDom",ref:y},null,512)],512)]),_:1})]))}});const ce=U($,[["__scopeId","data-v-3f157ceb"]]);export{ce as default};
