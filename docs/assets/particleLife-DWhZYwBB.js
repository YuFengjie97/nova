var z=Object.defineProperty;var D=(m,n,l)=>n in m?z(m,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):m[n]=l;var p=(m,n,l)=>(D(m,typeof n!="symbol"?n+"":n,l),l);import{c as H}from"./chroma-DCKfFEcf.js";import{i as J}from"./initStats-C5VNgmNK.js";import{i as K}from"./initGUI-CcmszmDW.js";import{d as Q,r as S,h as T,B as W,b as X,e as Y,o as Z}from"./index-BkxFcAok.js";import"./_commonjsHelpers-BosuxZz1.js";import"./dat.gui.module-DcMWPYuf.js";const r=10,y=1.6,k=.98,rt=Q({__name:"particleLife",setup(m){const{random:n,PI:l,min:A,abs:tt,sqrt:E,floor:B}=Math,x=S(),F=S(),N=H.scale(["#fd79a8","#81ecec","#00cec9","#d63031"]),R=r*100,b=[];let g=10,_=100,M=100,P=50,w=.5;function q(){for(let a=0;a<r;a++){const s=[];for(let h=0;h<r;h++)s.push(n()*2-1);b.push(s)}}q();function U(){for(let a=0;a<r;a++)for(let s=0;s<r;s++)b[a][s]=B(n()*2-1)}let I=0;return T(()=>{const{width:a,height:s}=x.value.getBoundingClientRect();F.value.width=a,F.value.height=s;const h=F.value.getContext("2d"),{stats:$}=J(x.value),{gui:L}=K(x.value),v={distMin:g,distMax:_,frictionFactor:k,pullFactor:M,pushFactor:P,tail:w,reset(){U(),j()}},f=L.addFolder("setting");f.open(),f.add(v,"distMin",0,20,1).onChange(t=>{g=t}),f.add(v,"pushFactor",1,200,1).onChange(t=>{P=t}),f.add(v,"distMax",20,B(A(a,s)),1).onChange(t=>{_=t}),f.add(v,"pullFactor",1,200,1).onChange(t=>{M=t}),f.add(v,"tail",0,1,.1).onFinishChange(t=>{w=t,h.fillStyle=`rgba(0,0,0,${1-w})`}),f.add(v,"reset");class O{constructor(e,o,c){p(this,"x",0);p(this,"y",0);p(this,"vx",0);p(this,"vy",0);p(this,"type",0);p(this,"canvasoff");this.x=e,this.y=o,this.type=c;const u=document.createElement("canvas");u.width=y*2,u.height=y*2;const i=u.getContext("2d"),C=N(c/r).css();i.beginPath(),i.fillStyle=C,i.arc(y,y,y,0,2*l),i.fill(),i.closePath(),this.canvasoff=u}edge(){return this.x<0||this.x>a||this.y<0||this.y>s?(this.x=n()*a,this.y=n()*s,!0):!1}accletorForce(e,o){return e<=g?(e/g-1)*M:e<_?P*o*(e-g)/(_-g):0}updateForce(e){const o=b[this.type][e.type],c=e.x-this.x,u=e.y-this.y,i=E(c**2+u**2),C=this.accletorForce(i,o)*.001;this.vx+=c/i*C,this.vy+=u/i*C}update(){this.edge()||(this.vx*=k,this.vy*=k,this.x+=this.vx,this.y+=this.vy)}draw(){h.drawImage(this.canvasoff,this.x,this.y)}}setInterval(()=>{V()},100);const d=[];function j(){d.length=0;for(let t=0;t<r;t++)for(let e=0;e<R/r;e++)d.push(new O(n()*a,n()*s,t))}j();function V(){for(let t=0;t<d.length;t++){const e=d[t];for(let o=0;o<d.length;o++){if(t===o)continue;const c=d[o];e.updateForce(c),c.updateForce(e)}}}h.fillStyle=`rgba(0,0,0,${1-w})`;function G(){$.update(),h.fillRect(0,0,a,s),d.forEach(t=>{t.update(),t.draw()}),I=requestAnimationFrame(G)}G()}),W(()=>{cancelAnimationFrame(I)}),(a,s)=>(Z(),X("div",{ref_key:"con",ref:x,class:"w-full h-full"},[Y("canvas",{ref_key:"canvas",ref:F,class:"block w-full h-full"},null,512)],512))}});export{rt as default};
