var T=Object.defineProperty;var $=(d,h,r)=>h in d?T(d,h,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[h]=r;var i=(d,h,r)=>($(d,typeof h!="symbol"?h+"":h,r),r);import{c as D}from"./chroma-DCKfFEcf.js";import{i as j}from"./initStats-C5VNgmNK.js";import{d as q,r as S,h as H,b as O,e as X,o as Y}from"./index-B4Kd1SlF.js";import"./_commonjsHelpers-BosuxZz1.js";const C="#8e44ad",n=40,o=2,m=10,y=4,p=5,L=5,Z=q({__name:"githubSnake",setup(d){const{random:h,PI:r,min:z,abs:g,sqrt:A,floor:l,ceil:V,round:G}=Math,E=D.scale(["#ebedf0","#27ae60"]),v=S(),I=S();return H(()=>{const{width:x,height:f}=v.value.getBoundingClientRect();I.value.width=x,I.value.height=f;const e=I.value.getContext("2d"),{stats:R}=j(v.value),w=l(f/n),b=l(x/n);class B{constructor(t,s,a){i(this,"x",0);i(this,"y",0);i(this,"aliveLevel",0);this.x=t,this.y=s,this.aliveLevel=a}draw(){e.fillStyle=E(this.aliveLevel/L).css();const t=this.x*n,s=this.y*n;e.beginPath(),e.roundRect(t+o,s+o,n-2*o,n-2*o,m),e.fill()}}const u={};for(let c=0;c<w;c++)for(let t=0;t<b;t++){const s=new B(t,c,l(h()*L));u[`${t},${c}`]=s}class F{constructor(t,s,a){i(this,"level",0);i(this,"x",0);i(this,"y",0);i(this,"xInc",0);i(this,"yInc",0);this.x=t,this.y=s,this.level=a}updatateInc(t,s){this.xInc=t,this.yInc=s}update(){this.x+=this.xInc*y,this.y+=this.yInc*y}draw(){e.fillStyle=C;const t=.4+(p-this.level)/p*.4,s=n*t,a=n*t,N=this.x+(1-t)/2*n,P=this.y+(1-t)/2*n;e.beginPath(),e.roundRect(N,P,s,a,m),e.fill()}}class M{constructor(){i(this,"xInd",l(b/2));i(this,"yInd",l(w/2));i(this,"x",this.xInd*n);i(this,"y",this.yInd*n);i(this,"xftInd",this.xInd-2);i(this,"yftInd",this.yInd);i(this,"xdtInd",this.xInd-1);i(this,"ydtInd",this.yInd);i(this,"xdt",this.xdtInd*n);i(this,"ydt",this.ydtInd*n);i(this,"xInc",-1);i(this,"yInc",0);i(this,"done",!1);i(this,"tails",[]);i(this,"history",[{xInc:this.xInc,yInc:this.yInc}]);for(let t=0;t<p;t++){const s=new F(this.x,this.y,t);this.tails.push(s)}}updateNextDir(){let t=this.xftInd-this.xInd,s=this.yftInd-this.yInd;t=t>0?1:t===0?0:-1,s=s>0?1:s===0?0:-1,t!==0&&s!==0&&(h()<.5?t=0:s=0),this.xInc=t,this.yInc=s,this.xdtInd=this.xInd+t,this.ydtInd=this.yInd+s,this.xdt=this.xdtInd*n,this.ydt=this.ydtInd*n}updateFinTar(){const t=Object.values(u).filter(a=>a.aliveLevel!==0);if(t.length===0){this.done=!0;return}const s=t[l(h()*t.length)];this.xftInd=s.x,this.yftInd=s.y}eat(){u[`${this.xInd},${this.yInd}`].aliveLevel=0,this.xftInd===this.xInd&&this.yftInd===this.yInd&&(this.updateFinTar(),this.updateNextDir()),this.updateNextDir(),this.updateHistory()}updateHistory(){this.history.length===p+1&&this.history.pop(),this.history.unshift({xInc:this.xInc,yInc:this.yInc}),this.tails.forEach((t,s)=>{if(s<this.history.length-1){const a=this.history[s+1];t.updatateInc(a.xInc,a.yInc)}})}update(){this.done||(this.x+=this.xInc*y,this.y+=this.yInc*y,this.xInd=l(this.x/n),this.yInd=l(this.y/n),g(this.xdt-this.x)<y&&g(this.ydt-this.y)<y&&this.eat(),this.tails.forEach(t=>{t.update()}))}draw(){e.fillStyle=C,e.beginPath(),e.roundRect(this.x+o,this.y+o,n-2*o,n-2*o,m),e.fill(),this.tails.forEach(t=>t.draw())}}const _=new M;function k(){R.update(),e.fillStyle="#fff",e.fillRect(0,0,x,f),Object.values(u).forEach(c=>c.draw()),_.update(),_.draw(),requestAnimationFrame(k)}k()}),(x,f)=>(Y(),O("div",{ref_key:"con",ref:v,class:"w-full h-full"},[X("canvas",{ref_key:"canvas",ref:I,class:"block w-full h-full"},null,512)],512))}});export{Z as default};
