import{d as ee,r as M,aL as te,av as oe,j as ne,V as se,aH as ae,ah as R,aC as D,R as I,M as re,L as T,aD as ie,U as le,a0 as ce,aE as de,S as he,I as me,P as ue,W as pe,J as ge,K as fe,O as ve,C as we,e as Ce,f as B,aq as be,o as xe,_ as ye}from"./index-CqfaNC88.js";import{S as Me}from"./stats.module--VATS4Kh.js";import{R as Pe,E as U,S as Ee}from"./RenderPass-t97LsirO.js";import{U as _e}from"./UnrealBloomPass-XoO1lnKb.js";import{i as Se}from"./initGUI-oTOkqKW2.js";import"./dat.gui.module-DYGKXP-V.js";const H=1,Le=ee({__name:"Atom",setup(Ae){const{random:O,PI:x}=Math,P=M(),E=M();let m=window.innerWidth,u=window.innerHeight,y,v,r,p,d,g,w,h,C,f,c;const _=new te;_.set(H);const b={},k=new oe({color:0}),o={showAxes:!1,atomColor:7816649,bloomStrength:5,bloomThreshold:0,bloomRadius:1,lightIntensity:10,lightDistance:90,lightDecay:1,electronNum:100,tInc:.001,electronColor:623843,orbitColor:16611752,showOrbit:!1};ne(()=>{F(),Z(),q(),V(),W(),A()});function G(){z()}const S=M();function F(){const{gui:n}=Se(S.value);n.add(o,"showAxes").onChange(e=>{w.visible=e});const t=n.addFolder("Atom");t.open(),t.addColor(o,"atomColor").onChange(e=>{c.mesh.material.color.setHex(e),g.color.setHex(e)}),t.add(o,"bloomStrength",0,10,.1).onChange(e=>{f.strength=e}),t.add(o,"bloomThreshold",0,5,.1).onChange(e=>{f.threshold=e}),t.add(o,"bloomRadius",0,5,.1).onChange(e=>{f.radius=e}),t.add(o,"lightIntensity",0,200,1).onChange(e=>{g.intensity=e}),t.add(o,"lightDistance",0,160,1).onChange(e=>{g.distance=e}),t.add(o,"lightDecay",0,2,.01).onChange(e=>{g.decay=e});const s=n.addFolder("Electron");s.open(),s.add(o,"electronNum",1,100,1).onChange(e=>{c.updateElectronNum(e)}),s.add(o,"tInc",0,.02,.001).name("velocity"),s.addColor(o,"electronColor").onChange(e=>{c.electrons.forEach(a=>{a.updateColor(e)})}),s.add(o,"showOrbit").onChange(e=>{c.electrons.forEach(a=>{a.orbitMesh.visible=e})}),s.addColor(o,"orbitColor").onChange(e=>{c.electrons.forEach(a=>{a.orbitMesh.material.color.set(e)})})}function N(n,t,s){const{lightIntensity:e,lightDistance:a,lightDecay:i}=o,l=new be(o.atomColor,e,a,i);return l.position.set(n,t,s),r.add(l),l}function W(){g=N(0,0,0)}function V(){c=new Q(o.electronNum)}function z(){c.electrons.forEach(n=>{n.moveByCurve()})}function q(){const n=new Pe(r,p),{bloomStrength:t,bloomRadius:s,bloomThreshold:e}=o;f=new _e(new se(window.innerWidth,window.innerHeight),t,s,e),h=new U(d),h.renderToScreen=!1,h.addPass(n),h.addPass(f);const a=`
  varying vec2 vUv;
  void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
  }
  `,i=`
  uniform sampler2D baseTexture;
  uniform sampler2D bloomTexture;
  varying vec2 vUv;
  void main() {
    gl_FragColor = ( texture2D( baseTexture, vUv ) + vec4( 1.0 ) * texture2D( bloomTexture, vUv ) );
  }
  `;C=new U(d);const l=new Ee(new ae({uniforms:{baseTexture:{value:null},bloomTexture:{value:h.renderTarget2.texture}},vertexShader:a,fragmentShader:i,defines:{}}),"baseTexture");l.needsSwap=!0,C.addPass(n),C.addPass(l)}function J(){r.traverse(K),h.render(),r.traverse(Y),C.render()}function K(n){const t=n.material;t&&_.test(n.layers)===!1&&(b[n.uuid]=t,n.material=k)}function Y(n){b[n.uuid]&&(n.material=b[n.uuid],delete b[n.uuid])}class Q{constructor(t){this.r=40,this.curveR=80,this.electrons=[];const s=new R(this.r,128,128),e=new D({color:o.atomColor}),a=new I(s,e);a.layers.enable(H),this.mesh=a,r.add(a);for(let i=0;i<t;i++)this.electrons.push(new X(x*2/t*i,this.curveR))}updateElectronNum(t){const s=x*2/t;this.electrons.forEach((e,a)=>{a<t?(e.updateOrbitRotation(s*a),e.group.visible=!0):e.group.visible=!1})}}class X{constructor(t,s){this.r=2,this.group=new re,this.t=O(),this.v=new T,this.curveR=s,r.add(this.group);const e=new R(this.r,128,128),a=new D({color:o.electronColor});this.mesh=new I(e,a),this.group.add(this.mesh),this.orbitCurve=new ie(0,0,s,s,0,2*Math.PI,!0,x/3);const i=this.orbitCurve.getSpacedPoints(300),l=new le().setFromPoints(i),j=new ce({color:o.orbitColor});this.orbitMesh=new de(l,j),this.orbitMesh.visible=o.showOrbit,this.group.add(this.orbitMesh),this.group.rotation.x=t,this.group.rotation.y=t}moveByCurve(){this.t>=1&&(this.t=0),this.t+=o.tInc;const t=this.orbitCurve.getPointAt(this.t);this.mesh.position.x=t.x,this.mesh.position.y=t.y}updateOrbitRotation(t){this.group.rotation.x=t,this.group.rotation.y=t}updateColor(t){this.mesh.material.color.set(t)}}function Z(){r=new he,r.background=new me(0),p=new ue(75,m/u,.1,1e3),d=new pe({canvas:P.value,antialias:!0}),d.setSize(m,u),window.addEventListener("resize",$),w=new ge(1e3),w.visible=o.showAxes,r.add(w),r.add(new fe(4210752)),y=Me(),E.value.append(y.dom),v=new ve(p,d.domElement),v.target=new T(0,0,0),v.object.position.set(0,0,200),v.update()}let L=0;function A(){y.update(),G(),J(),L=requestAnimationFrame(A)}function $(){m=window.innerWidth,u=window.innerHeight,p.aspect=m/u,p.updateProjectionMatrix(),d.setSize(m,u)}return we(()=>{cancelAnimationFrame(L)}),(n,t)=>(xe(),Ce("div",{ref_key:"con",ref:S},[B("div",{ref_key:"canvasCon",ref:E,class:"canvasCon"},[B("canvas",{ref_key:"canvasDom",ref:P,class:"canvas"},null,512)],512)],512))}}),He=ye(Le,[["__scopeId","data-v-05a69412"]]);export{He as default};
