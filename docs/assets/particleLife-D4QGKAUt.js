var V=Object.defineProperty;var z=(m,n,l)=>n in m?V(m,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):m[n]=l;var p=(m,n,l)=>(z(m,typeof n!="symbol"?n+"":n,l),l);import{c as D}from"./chroma-Y-Vb8avc.js";import{d as H,r as G,j as K,J as Q,E as T,e as W,f as X,o as Y}from"./index-C5HxIGZc.js";import{i as Z}from"./initGUI-CcmszmDW.js";import"./dat.gui.module-DcMWPYuf.js";const r=10,y=1.6,j=.98,it=H({__name:"particleLife",setup(m){const{random:n,PI:l,min:S,abs:tt,sqrt:A,floor:k}=Math,x=G(),F=G(),N=D.scale(["#fd79a8","#81ecec","#00cec9","#d63031"]),R=r*100,M=[];let g=10,_=100,P=100,b=50,w=.5;function q(){for(let a=0;a<r;a++){const s=[];for(let h=0;h<r;h++)s.push(n()*2-1);M.push(s)}}q();function U(){for(let a=0;a<r;a++)for(let s=0;s<r;s++)M[a][s]=k(n()*2-1)}let I=0;return K(()=>{const{width:a,height:s}=x.value.getBoundingClientRect();F.value.width=a,F.value.height=s;const h=F.value.getContext("2d"),{stats:$}=Q(x.value),{gui:J}=Z(x.value),v={distMin:g,distMax:_,frictionFactor:j,pullFactor:P,pushFactor:b,tail:w,reset(){U(),B()}},f=J.addFolder("setting");f.open(),f.add(v,"distMin",0,20,1).onChange(t=>{g=t}),f.add(v,"pushFactor",1,200,1).onChange(t=>{b=t}),f.add(v,"distMax",20,k(S(a,s)),1).onChange(t=>{_=t}),f.add(v,"pullFactor",1,200,1).onChange(t=>{P=t}),f.add(v,"tail",0,1,.1).onFinishChange(t=>{w=t,h.fillStyle=`rgba(0,0,0,${1-w})`}),f.add(v,"reset");class L{constructor(e,o,c){p(this,"x",0);p(this,"y",0);p(this,"vx",0);p(this,"vy",0);p(this,"type",0);p(this,"canvasoff");this.x=e,this.y=o,this.type=c;const u=document.createElement("canvas");u.width=y*2,u.height=y*2;const i=u.getContext("2d"),C=N(c/r).css();i.beginPath(),i.fillStyle=C,i.arc(y,y,y,0,2*l),i.fill(),i.closePath(),this.canvasoff=u}edge(){return this.x<0||this.x>a||this.y<0||this.y>s?(this.x=n()*a,this.y=n()*s,!0):!1}accletorForce(e,o){return e<=g?(e/g-1)*P:e<_?b*o*(e-g)/(_-g):0}updateForce(e){const o=M[this.type][e.type],c=e.x-this.x,u=e.y-this.y,i=A(c**2+u**2),C=this.accletorForce(i,o)*.001;this.vx+=c/i*C,this.vy+=u/i*C}update(){this.edge()||(this.vx*=j,this.vy*=j,this.x+=this.vx,this.y+=this.vy)}draw(){h.drawImage(this.canvasoff,this.x,this.y)}}setInterval(()=>{O()},100);const d=[];function B(){d.length=0;for(let t=0;t<r;t++)for(let e=0;e<R/r;e++)d.push(new L(n()*a,n()*s,t))}B();function O(){for(let t=0;t<d.length;t++){const e=d[t];for(let o=0;o<d.length;o++){if(t===o)continue;const c=d[o];e.updateForce(c),c.updateForce(e)}}}h.fillStyle=`rgba(0,0,0,${1-w})`;function E(){$.update(),h.fillRect(0,0,a,s),d.forEach(t=>{t.update(),t.draw()}),I=requestAnimationFrame(E)}E()}),T(()=>{cancelAnimationFrame(I)}),(a,s)=>(Y(),W("div",{ref_key:"con",ref:x,class:"w-full h-full"},[X("canvas",{ref_key:"canvas",ref:F,class:"block w-full h-full"},null,512)],512))}});export{it as default};
