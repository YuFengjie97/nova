import{c as M}from"./index-T8xJO8QF.js";import{d as N,r as _,j as T,H as $,e as j,f as D,o as H}from"./index-CqfaNC88.js";const b="#8e44ad",i=40,c=2,u=10,l=4,I=5,k=5,Y=N({__name:"githubSnake",setup(P){const{random:x,abs:p,floor:a}=Math,S=M.scale(["#ebedf0","#27ae60"]),f=_(),o=_();return T(()=>{const{width:d,height:r}=f.value.getBoundingClientRect();o.value.width=d,o.value.height=r;const n=o.value.getContext("2d"),{stats:C}=$(f.value),v=a(r/i),g=a(d/i);class L{constructor(t,s,e){this.x=0,this.y=0,this.aliveLevel=0,this.x=t,this.y=s,this.aliveLevel=e}draw(){n.fillStyle=S(this.aliveLevel/k).css();const t=this.x*i,s=this.y*i;n.beginPath(),n.roundRect(t+c,s+c,i-2*c,i-2*c,u),n.fill()}}const y={};for(let h=0;h<v;h++)for(let t=0;t<g;t++){const s=new L(t,h,a(x()*k));y[`${t},${h}`]=s}class E{constructor(t,s,e){this.level=0,this.x=0,this.y=0,this.xInc=0,this.yInc=0,this.x=t,this.y=s,this.level=e}updatateInc(t,s){this.xInc=t,this.yInc=s}update(){this.x+=this.xInc*l,this.y+=this.yInc*l}draw(){n.fillStyle=b;const t=.4+(I-this.level)/I*.4,s=i*t,e=i*t,B=this.x+(1-t)/2*i,F=this.y+(1-t)/2*i;n.beginPath(),n.roundRect(B,F,s,e,u),n.fill()}}class R{constructor(){this.xInd=a(g/2),this.yInd=a(v/2),this.x=this.xInd*i,this.y=this.yInd*i,this.xftInd=this.xInd-2,this.yftInd=this.yInd,this.xdtInd=this.xInd-1,this.ydtInd=this.yInd,this.xdt=this.xdtInd*i,this.ydt=this.ydtInd*i,this.xInc=-1,this.yInc=0,this.done=!1,this.tails=[],this.history=[{xInc:this.xInc,yInc:this.yInc}];for(let t=0;t<I;t++){const s=new E(this.x,this.y,t);this.tails.push(s)}}updateNextDir(){let t=this.xftInd-this.xInd,s=this.yftInd-this.yInd;t=t>0?1:t===0?0:-1,s=s>0?1:s===0?0:-1,t!==0&&s!==0&&(x()<.5?t=0:s=0),this.xInc=t,this.yInc=s,this.xdtInd=this.xInd+t,this.ydtInd=this.yInd+s,this.xdt=this.xdtInd*i,this.ydt=this.ydtInd*i}updateFinTar(){const t=Object.values(y).filter(e=>e.aliveLevel!==0);if(t.length===0){this.done=!0;return}const s=t[a(x()*t.length)];this.xftInd=s.x,this.yftInd=s.y}eat(){y[`${this.xInd},${this.yInd}`].aliveLevel=0,this.xftInd===this.xInd&&this.yftInd===this.yInd&&(this.updateFinTar(),this.updateNextDir()),this.updateNextDir(),this.updateHistory()}updateHistory(){this.history.length===I+1&&this.history.pop(),this.history.unshift({xInc:this.xInc,yInc:this.yInc}),this.tails.forEach((t,s)=>{if(s<this.history.length-1){const e=this.history[s+1];t.updatateInc(e.xInc,e.yInc)}})}update(){this.done||(this.x+=this.xInc*l,this.y+=this.yInc*l,this.xInd=a(this.x/i),this.yInd=a(this.y/i),p(this.xdt-this.x)<l&&p(this.ydt-this.y)<l&&this.eat(),this.tails.forEach(t=>{t.update()}))}draw(){n.fillStyle=b,n.beginPath(),n.roundRect(this.x+c,this.y+c,i-2*c,i-2*c,u),n.fill(),this.tails.forEach(t=>t.draw())}}const w=new R;function m(){C.update(),n.fillStyle="#fff",n.fillRect(0,0,d,r),Object.values(y).forEach(h=>h.draw()),w.update(),w.draw(),requestAnimationFrame(m)}m()}),(d,r)=>(H(),j("div",{ref_key:"con",ref:f,class:"w-full h-full"},[D("canvas",{ref_key:"canvas",ref:o,class:"block w-full h-full"},null,512)],512))}});export{Y as default};
