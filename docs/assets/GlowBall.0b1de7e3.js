import{G as B}from"./dat.gui.module.5aaed78b.js";import{I as N,C as A,a1 as x,e as D,c as W,aa as z,S as V,P as H,W as I,a as O,V as F,ae as Y}from"./three.module.c94f3e3c.js";import{O as $}from"./OrbitControls.d920b2db.js";import{R as q,U as J,E as M,S as K}from"./UnrealBloomPass.d4fbf360.js";import{d as Q,b as y,h as X,c as Z,a as C,o as j,_ as ee}from"./index.dd42b8fd.js";const ne={class:"viewCon"},ae=Q({__name:"GlowBall",setup(oe){const g=y(),S=y();let d=window.innerWidth,c=window.innerHeight,u,i,o,s,r,t,w;const p=1,_=0;X(()=>{P(),U(),G(),T(),l()});const a={exposure:1,bloomStrength:5,bloomThreshold:0,bloomRadius:0,scene:"normalAndGlow"};function P(){let e=new B;e.add(a,"exposure",.1,2).onChange(function(n){s.toneMappingExposure=Math.pow(n,4),l()}),e.add(a,"bloomThreshold",0,1).onChange(function(n){r.threshold=Number(n),l()}),e.add(a,"bloomStrength",0,10).onChange(function(n){r.strength=Number(n),l()}),e.add(a,"bloomRadius",0,1,.001).onChange(function(n){r.radius=Number(n),l()}),e.add(a,"scene",["normalAndGlow","onlyNnormal","onlyGlow"]).onChange(n=>{a.scene=n,l()})}function G(){const e=new N(1,15);for(let n=0;n<50;n++){const h=new A;h.setHSL(Math.random(),.7,.3);const v=new x({color:h}),m=new D(e,v);m.position.x=Math.random()*10-5,m.position.y=Math.random()*10-5,m.position.z=Math.random()*10-5,m.scale.setScalar(Math.random()*Math.random()+.5),m.layers.enable(n%2===0?p:_),i.add(m)}}function T(){const e=`varying vec2 vUv;
  void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
  }
  `,n=`uniform sampler2D baseTexture;
  uniform sampler2D bloomTexture;
  varying vec2 vUv;
  void main() {
    gl_FragColor = ( texture2D( baseTexture, vUv ) + vec4( 1.0 ) * texture2D( bloomTexture, vUv ) );
  }
  `,h=new q(i,o);r=new J(new W(window.innerWidth,window.innerHeight),1.5,.4,.85),r.threshold=a.bloomThreshold,r.strength=a.bloomStrength,r.radius=a.bloomRadius,t=new M(s),t.addPass(h),t.addPass(r);const v=new K(new z({uniforms:{baseTexture:{value:null},bloomTexture:{value:t.renderTarget2.texture}},vertexShader:e,fragmentShader:n,defines:{}}),"baseTexture");v.needsSwap=!0,w=new M(s),w.addPass(h),w.addPass(v)}function l(){let{scene:e}=a;e==="onlyNnormal"?(o.layers.set(_),s.render(i,o)):e==="onlyGlow"?(o.layers.set(p),t.renderToScreen=!0,t.render(),o.layers.set(_)):e==="normalAndGlow"&&(t.renderToScreen=!1,i.traverse(L),t.render(),i.traverse(R),w.render())}const f={},E=new x({color:"black"}),b=new Y;b.set(p);function L(e){e.isMesh&&b.test(e.layers)===!1&&(f[e.uuid]=e.material,e.material=E)}function R(e){f[e.uuid]&&(e.material=f[e.uuid],delete f[e.uuid])}function U(){i=new V,o=new H(75,d/c,.1,1e3),s=new I({canvas:g.value,antialias:!0}),s.setSize(d,c),window.addEventListener("resize",k),i.add(new O(4210752)),u=new $(o,s.domElement),u.target=new F(0,0,0),u.object.position.set(10,10,10),u.update(),u.addEventListener("change",l)}function k(){d=window.innerWidth,c=window.innerHeight,o.aspect=d/c,o.updateProjectionMatrix(),s.setSize(d,c),t.setSize(d,c)}return(e,n)=>(j(),Z("div",ne,[C("div",{class:"canvasCon",ref_key:"canvasCon",ref:S},[C("canvas",{class:"canvas",ref_key:"canvasDom",ref:g},null,512)],512)]))}});const de=ee(ae,[["__scopeId","data-v-53e48252"]]);export{de as default};
