import{c as L}from"./index-T8xJO8QF.js";import{d as O,r as b,j as V,H as z,C as D,e as J,f as K,o as Q}from"./index-CqfaNC88.js";import{i as T}from"./initGUI-oTOkqKW2.js";import"./dat.gui.module-DYGKXP-V.js";const c=10,m=1.6,M=.98,et=O({__name:"particleLife",setup(W){const{random:f,PI:B,min:G,sqrt:S,floor:P}=Math,g=b(),y=b(),A=L.scale(["#fd79a8","#81ecec","#00cec9","#d63031"]),E=c*100,C=[];let u=10,v=100,_=100,w=50,x=.5;function N(){for(let s=0;s<c;s++){const n=[];for(let r=0;r<c;r++)n.push(f()*2-1);C.push(n)}}N();function R(){for(let s=0;s<c;s++)for(let n=0;n<c;n++)C[s][n]=P(f()*2-1)}let j=0;return V(()=>{const{width:s,height:n}=g.value.getBoundingClientRect();y.value.width=s,y.value.height=n;const r=y.value.getContext("2d"),{stats:q}=z(g.value),{gui:U}=T(g.value),p={distMin:u,distMax:v,frictionFactor:M,pullFactor:_,pushFactor:w,tail:x,reset(){R(),k()}},l=U.addFolder("setting");l.open(),l.add(p,"distMin",0,20,1).onChange(t=>{u=t}),l.add(p,"pushFactor",1,200,1).onChange(t=>{w=t}),l.add(p,"distMax",20,P(G(s,n)),1).onChange(t=>{v=t}),l.add(p,"pullFactor",1,200,1).onChange(t=>{_=t}),l.add(p,"tail",0,1,.1).onFinishChange(t=>{x=t,r.fillStyle=`rgba(0,0,0,${1-x})`}),l.add(p,"reset");class ${constructor(e,a,o){this.x=0,this.y=0,this.vx=0,this.vy=0,this.type=0,this.x=e,this.y=a,this.type=o;const d=document.createElement("canvas");d.width=m*2,d.height=m*2;const i=d.getContext("2d"),F=A(o/c).css();i.beginPath(),i.fillStyle=F,i.arc(m,m,m,0,2*B),i.fill(),i.closePath(),this.canvasoff=d}edge(){return this.x<0||this.x>s||this.y<0||this.y>n?(this.x=f()*s,this.y=f()*n,!0):!1}accletorForce(e,a){return e<=u?(e/u-1)*_:e<v?w*a*(e-u)/(v-u):0}updateForce(e){const a=C[this.type][e.type],o=e.x-this.x,d=e.y-this.y,i=S(o**2+d**2),F=this.accletorForce(i,a)*.001;this.vx+=o/i*F,this.vy+=d/i*F}update(){this.edge()||(this.vx*=M,this.vy*=M,this.x+=this.vx,this.y+=this.vy)}draw(){r.drawImage(this.canvasoff,this.x,this.y)}}setInterval(()=>{H()},100);const h=[];function k(){h.length=0;for(let t=0;t<c;t++)for(let e=0;e<E/c;e++)h.push(new $(f()*s,f()*n,t))}k();function H(){for(let t=0;t<h.length;t++){const e=h[t];for(let a=0;a<h.length;a++){if(t===a)continue;const o=h[a];e.updateForce(o),o.updateForce(e)}}}r.fillStyle=`rgba(0,0,0,${1-x})`;function I(){q.update(),r.fillRect(0,0,s,n),h.forEach(t=>{t.update(),t.draw()}),j=requestAnimationFrame(I)}I()}),D(()=>{cancelAnimationFrame(j)}),(s,n)=>(Q(),J("div",{ref_key:"con",ref:g,class:"w-full h-full"},[K("canvas",{ref_key:"canvas",ref:y,class:"block w-full h-full"},null,512)],512))}});export{et as default};
