var S=Object.defineProperty;var v=(e,a,n)=>a in e?S(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n;var i=(e,a,n)=>(v(e,typeof a!="symbol"?a+"":a,n),n);import{a as E}from"./p5.min-5fbo9jiI.js";import{P as V}from"./P5Con-AQnxSAuV.js";import{A as L}from"./AudioController-H3jOTXyb.js";import{i as O,n as R}from"./p5bezier-qKYVoer2.js";import{a as F}from"./audio-sugarCrush-b-otqC__.js";import{b as H}from"./math-xGOdA9b-.js";import{d as N,r as T,o as W,b as j,l as g,u as q}from"./index-Qb02CAS_.js";const G={class:"w-full h-full"},oo=N({__name:"MusicCircle",setup(e){const{PI:a,random:n,floor:x,min:P}=Math;let u,l;const m=T(64),d=m.value/2,p=[],c=[];let f;const _=250,h=100,b=.9,w="#5f27cd";class A{constructor(t,s,r){i(this,"$p");i(this,"angle");i(this,"basePos");i(this,"pos");i(this,"r",2);i(this,"audioIndex",0);i(this,"h",0);i(this,"count",0);this.$p=t,this.angle=s,this.basePos=E.Vector.fromAngle(s,P(u,l)/2*b),this.pos=this.basePos.copy(),this.audioIndex=r}draw(){const{$p:t,pos:{x:s,y:r},h:M,count:D}=this;t.noStroke(),t.fill((M+D)%255,255,127),t.circle(s,r,this.r*2)}update(t){this.pos=this.basePos.copy().mult(t),this.h=x(t*255),this.count++}}function I(o){f=o}function k(o){const t=H(d);for(let s=0;s<d;s++)p.push(new A(o,a*2/d*s,t()??0))}function y(){const o=f.getAudioData();c.length=0,p.forEach(t=>{const s=o[t.audioIndex],r=s<h?h:s;t.update(r/_),t.draw(),s>h&&c.push([t.pos.x,t.pos.y])})}function z(o){o.noFill(),o.stroke(w),o.strokeWeight(2),c.length>=10&&R(c,"CLOSE")}function C(o,t){u=o.width,l=o.height,o.colorMode(o.HSB),O(t),k(o)}function B(o){o.translate(u/2,l/2),o.background("rgba(0, 0, 0, 0.07)"),f&&(y(),z(o))}return(o,t)=>(W(),j("div",G,[g(L,{class:"absolute top-0 left-0 z-100","audio-src":q(F),"fft-size":m.value,onInitAudioAnalyser:I},null,8,["audio-src","fft-size"]),g(V,{setup:C,draw:B})]))}});export{oo as default};
