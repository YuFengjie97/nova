var tt=Object.defineProperty;var et=(h,a,l)=>a in h?tt(h,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):h[a]=l;var r=(h,a,l)=>(et(h,typeof a!="symbol"?a+"":a,l),l);import{d as nt,r as W,E as at,j as ot,e as it,C as st,at as rt,f as b,am as lt,au as ct,av as B,aw as dt,O as ht,L as ut,S as ft,K as mt,P as pt,W as wt,M as gt,o as xt,_ as vt}from"./index-CXaHQ9wk.js";import{S as yt}from"./stats.module--VATS4Kh.js";const Ct={class:"viewCon"},z=20,_t="Verdana",w=.5,Mt=nt({__name:"ThreeTextPoint",setup(h){const{random:a,PI:l}=Math;let L="Hello World";const S=W("Hello World");function V(){L=S.value,A(),N(),I()}const R=W(),k=W();let g=window.innerWidth,x=window.innerHeight,P,T,c,v,y,A,u=[];const f={};let E,H,i,m;const s={width:0,height:0};class ${constructor(t,d){r(this,"x");r(this,"y");r(this,"z",0);r(this,"rotationX",a()*2*l);r(this,"rotationY",a()*2*l);r(this,"rotationZ",a()*2*l);r(this,"deltaRotation",.2*(a()-.5));r(this,"scale",0);r(this,"deltaScale",.1);r(this,"toKeep",!0);this.x=t,this.y=d}update(){this.rotationX+=this.deltaRotation,this.rotationY+=this.deltaRotation,this.rotationZ+=this.deltaRotation,this.scale<1&&(this.scale+=this.deltaScale)}}function F(){const o=document.createElement("canvas"),t=o.getContext("2d");return o.width=o.height=0,function(){s.width=0,s.height=0;const d=L.split(`
`),C=d.reduce((e,n)=>n.length>e.length?n:e," ").length*z,_=d.length*z;o.width=C,o.height=_,t.font=`${z}px ${_t}`,t.fillStyle="red";for(let e=0,n=d.length;e<n;e++)t.fillText(d[e],0,(e+.8)*(_/n));const Q=t.getImageData(0,0,C,_),j=1;for(let e=0;e<_;e+=j)for(let n=0;n<C;n+=j){const p=`x:${n}y:${e}`;if(Q.data[(n+e*C)*4]>0)if(n>s.width&&(s.width=n),e>s.height&&(s.height=e),f[p])f[p].toKeep=!0;else{const M=new $(n*w,-e*w);u.push(M),f[p]=M}else f[p]&&(f[p].toKeep=!1,delete f[p]);u=u.filter(M=>M.toKeep)}}}function G(){E=new lt(.35,.15,16,50),H=new ct({}),i=new B(E,H,u.length),i.position.x=-.5*s.width*w,i.position.y=-1.5*s.height*w,c.add(i),m=new dt}function N(){c.remove(i),i=new B(E,H,u.length),i.position.x=-.5*s.width*w,i.position.y=-1.5*s.height*w,c.add(i)}function I(){let o=0;u.forEach(t=>{m.rotation.set(t.rotationX,t.rotationY,t.rotationZ),m.scale.set(t.scale,t.scale,t.scale),m.position.set(t.x,s.height+t.y,t.z),m.updateMatrix(),i.setMatrixAt(o,m.matrix),o++,t.update()}),i.instanceMatrix.needsUpdate=!0}function O(){P=yt(),k.value.append(P.dom)}function U(){T=new ht(v,y.domElement),T.object.position.set(0,0,30),T.target.set(0,0,0)}function X(){c.add(new ut(1e3))}function Y(){g=window.innerWidth,x=window.innerHeight,v.aspect=g/x,v.updateProjectionMatrix(),y.setSize(g,x)}function Z(){c=new ft,c.background=new mt(4473924),v=new pt(75,g/x,1,4e3),y=new wt({canvas:R.value,antialias:!0}),y.setSize(g,x),window.addEventListener("resize",Y)}function q(){const o=new gt(4210752);c.add(o)}function J(){I()}let D=0;function K(){D=requestAnimationFrame(K),P.update(),J(),y.render(c,v)}return at(()=>{cancelAnimationFrame(D)}),ot(()=>{Z(),U(),A=F(),A(),G(),I(),q(),X(),O(),K()}),(o,t)=>(xt(),it("div",Ct,[st(b("textarea",{"onUpdate:modelValue":t[0]||(t[0]=d=>S.value=d),class:"input",type:"text",rows:"5",cols:"50",onKeyup:V},null,544),[[rt,S.value]]),b("div",{ref_key:"canvasCon",ref:k,class:"canvasCon"},[b("canvas",{ref_key:"canvasDom",ref:R,class:"canvas"},null,512)],512)]))}}),Et=vt(Mt,[["__scopeId","data-v-4f5f8d30"]]);export{Et as default};
