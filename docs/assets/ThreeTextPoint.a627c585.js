var tt=Object.defineProperty;var et=(h,a,l)=>a in h?tt(h,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):h[a]=l;var r=(h,a,l)=>(et(h,typeof a!="symbol"?a+"":a,l),l);import{d as nt,b as E,h as at,c as ot,y as it,C as st,a as I,o as rt,_ as lt}from"./index.dd42b8fd.js";import{F as ct,X as dt,Y as B,Z as ht,A as ut,S as ft,C as pt,P as mt,W as wt,a as gt}from"./three.module.c94f3e3c.js";import{S as xt}from"./stats.module.f23e5c82.js";import{O as vt}from"./OrbitControls.d920b2db.js";const _t={class:"viewCon"},yt=nt({__name:"ThreeTextPoint",setup(h){const{random:a,PI:l}=Math;let R="Hello World";const M=E("Hello World");function V(){R=M.value,b(),j(),z()}const k=E(),D=E();let g=window.innerWidth,x=window.innerHeight,P,T,c,v,_,b;const A=20,X="Verdana",u=.5;let f=[];const p={};let H,W,i,m,s={width:0,height:0};class Y{constructor(t,d){r(this,"x");r(this,"y");r(this,"z",0);r(this,"rotationX",a()*2*l);r(this,"rotationY",a()*2*l);r(this,"rotationZ",a()*2*l);r(this,"deltaRotation",.2*(a()-.5));r(this,"scale",0);r(this,"deltaScale",.1);r(this,"toKeep",!0);this.x=t,this.y=d}update(){this.rotationX+=this.deltaRotation,this.rotationY+=this.deltaRotation,this.rotationZ+=this.deltaRotation,this.scale<1&&(this.scale+=this.deltaScale)}}function Z(){const o=document.createElement("canvas"),t=o.getContext("2d");return o.width=o.height=0,function(){s.width=0,s.height=0;const d=R.split(`
`),y=d.reduce((e,n)=>n.length>e.length?n:e," ").length*A,C=d.length*A;o.width=y,o.height=C,t.font=`${A}px ${X}`,t.fillStyle="red";for(let e=0,n=d.length;e<n;e++)t.fillText(d[e],0,(e+.8)*(C/n));const Q=t.getImageData(0,0,y,C);let K=1;for(let e=0;e<C;e+=K)for(let n=0;n<y;n+=K){let w=`x:${n}y:${e}`;if(Q.data[(n+e*y)*4]>0)if(n>s.width&&(s.width=n),e>s.height&&(s.height=e),p[w])p[w].toKeep=!0;else{let S=new Y(n*u,-e*u);f.push(S),p[w]=S}else p[w]&&(p[w].toKeep=!1,delete p[w]);f=f.filter(S=>S.toKeep)}}}function $(){H=new ct(.35,.15,16,50),W=new dt({}),i=new B(H,W,f.length),i.position.x=-.5*s.width*u,i.position.y=-1.5*s.height*u,c.add(i),m=new ht}function j(){c.remove(i),i=new B(H,W,f.length),i.position.x=-.5*s.width*u,i.position.y=-1.5*s.height*u,c.add(i)}function z(){let o=0;f.forEach(t=>{m.rotation.set(t.rotationX,t.rotationY,t.rotationZ),m.scale.set(t.scale,t.scale,t.scale),m.position.set(t.x,s.height+t.y,t.z),m.updateMatrix(),i.setMatrixAt(o,m.matrix),o++,t.update()}),i.instanceMatrix.needsUpdate=!0}function F(){P=xt(),D.value.append(P.dom)}function G(){T=new vt(v,_.domElement),T.object.position.set(0,0,30),T.target.set(0,0,0)}function N(){c.add(new ut(1e3))}function O(){g=window.innerWidth,x=window.innerHeight,v.aspect=g/x,v.updateProjectionMatrix(),_.setSize(g,x)}function U(){c=new ft,c.background=new pt(4473924),v=new mt(75,g/x,1,4e3),_=new wt({canvas:k.value,antialias:!0}),_.setSize(g,x),window.addEventListener("resize",O)}function q(){const o=new gt(4210752);c.add(o)}function J(){z()}function L(){requestAnimationFrame(L),P.update(),J(),_.render(c,v)}return at(()=>{U(),G(),b=Z(),b(),$(),z(),q(),N(),F(),L()}),(o,t)=>(rt(),ot("div",_t,[it(I("textarea",{class:"input",type:"text",rows:"5",cols:"50","onUpdate:modelValue":t[0]||(t[0]=d=>M.value=d),onKeyup:V},null,544),[[st,M.value]]),I("div",{class:"canvasCon",ref_key:"canvasCon",ref:D},[I("canvas",{class:"canvas",ref_key:"canvasDom",ref:k},null,512)],512)]))}});const At=lt(yt,[["__scopeId","data-v-d15b7170"]]);export{At as default};
