var H=Object.defineProperty;var J=(u,s,f)=>s in u?H(u,s,{enumerable:!0,configurable:!0,writable:!0,value:f}):u[s]=f;var C=(u,s,f)=>(J(u,typeof s!="symbol"?s+"":s,f),f);import{b as K}from"./simplex-noise-BtZ5wMFy.js";import{d as O,r as Q,j as X,N as Y,R as S,$ as tt,a0 as E,a2 as et,aV as ot,Z as st,a3 as nt,e as it,o as rt}from"./index-Dk52mj26.js";import{c as at}from"./chroma-D8b-vtvi.js";import{i as ct}from"./initThree-CPuUtzyO.js";import{p as lt}from"./dotTexture-NXlc0I5v.js";import"./OrbitControls-Rz_z-Chd.js";import"./initStats-z-qGLZo8.js";const I=1e4,m=100,w=4,R=2,vt=O({__name:"flowFieldPoint3D",setup(u){const{random:s,PI:f,sin:D,cos:L,floor:z}=Math,T=at.scale(["#00b894","#0984e3","#6c5ce7","#fdcb6e","#e84393"]),U=K(),$=Q(),t=new Float32Array(I*3),v=new Float32Array(I*3);let a=0,c=0,n=20;const F=[],y={};class V{constructor(i){C(this,"ind");C(this,"vel");this.ind=i,this.vel=new S(0,0,0)}getPos(){return{x:t[this.ind*3],y:t[this.ind*3+1],z:t[this.ind*3+2]}}edge(){const{x:i,y:d,z:h}=this.getPos();i<0&&(t[this.ind*3]=a),i>a&&(t[this.ind*3]=0),d<0&&(t[this.ind*3+1]=c),d>c&&(t[this.ind*3+1]=0),h<0&&(t[this.ind*3+2]=m),h>m&&(t[this.ind*3+2]=0)}update(i,d){this.edge();const[h,_,M]=T(i).gl();v[this.ind*3]=h,v[this.ind*3+1]=_,v[this.ind*3+2]=M,this.vel.add(d),this.vel.length()>R&&this.vel.setLength(R),t[this.ind*3]+=this.vel.x,t[this.ind*3+1]+=this.vel.y,t[this.ind*3+2]+=this.vel.z}}return X(()=>{const{width:b,height:i}=$.value.getBoundingClientRect();a=b/4,c=i/4,n=i/40;const{scene:d,camera:h,renderWrap:_,orbitControls:M}=ct($.value,!1,!1,!1);h.position.set(a/2,c/2,m*2),h.lookAt(a/2,c/2,0),d.background=new Y(0);for(let e=-1;e*n<a+n;e+=1)for(let o=-1;o*n<c+n;o+=1)for(let r=-1;r*w<m+w;r+=1)y[`${e},${o},${r}`]={n:0,v:new S(0,0,0)};for(let e=0;e<I;e++){const o=s()*a,r=s()*c,l=s()*m;t[e*3]=o,t[e*3+1]=r,t[e*3+2]=l,F.push(new V(e))}const A=new tt;A.setAttribute("position",new E(t,3)),A.setAttribute("color",new E(v,3));const Z=new et({size:1.5,map:new ot().load(lt),blending:st,transparent:!1,sizeAttenuation:!0,vertexColors:!0}),P=new nt(A,Z);d.add(P);const j=.05,G=.05,W=.01;let N=0;const q=.01;_(()=>{N+=q;let e=0;for(let o=-1;o*n<a+n;o+=1){e+=j;let r=0;for(let l=-1;l*n<c+n;l+=1){r+=G;let x=0;for(let p=-1;p*w<m+w;p+=1){x+=W;const g=U(e,r,x,N)*.5+.5,B=4*f*g,k=R*.1*g;y[`${o},${l},${p}`].n=g,y[`${o},${l},${p}`].v.set(L(B)*k,D(B)*k,D(B)*k)}}}F.forEach(o=>{const{x:r,y:l,z:x}=o.getPos(),{n:p,v:g}=y[`${z(r/n)},${z(l/n)},${z(x/w)}`];o.update(p,g)}),P.geometry.attributes.position.needsUpdate=!0,P.geometry.attributes.color.needsUpdate=!0})()}),(b,i)=>(rt(),it("div",{ref_key:"con",ref:$,class:"w-full h-full"},null,512))}});export{vt as default};
