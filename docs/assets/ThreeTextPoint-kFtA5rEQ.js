var et=Object.defineProperty;var nt=(h,a,l)=>a in h?et(h,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):h[a]=l;var r=(h,a,l)=>(nt(h,typeof a!="symbol"?a+"":a,l),l);import{d as at,r as W,C as ot,h as it,o as st,b as rt,A as lt,au as ct,e as z,ag as dt,av as ht,aw as G,ax as ut,G as ft,S as mt,E as pt,P as wt,W as gt,H as xt,_ as vt}from"./index-somVfJ8D.js";import{S as yt}from"./stats.module-nRd2dy6L.js";import{O as Ct}from"./OrbitControls-Qre0769Z.js";const _t={class:"viewCon"},St=at({__name:"ThreeTextPoint",setup(h){const{random:a,PI:l}=Math;let R="Hello World";const M=W("Hello World");function V(){R=M.value,H(),O(),I()}const k=W(),D=W();let g=window.innerWidth,x=window.innerHeight,P,A,c,v,y,H;const T=20,$="Verdana",u=.5;let f=[];const m={};let b,E,i,p;const s={width:0,height:0};class j{constructor(t,d){r(this,"x");r(this,"y");r(this,"z",0);r(this,"rotationX",a()*2*l);r(this,"rotationY",a()*2*l);r(this,"rotationZ",a()*2*l);r(this,"deltaRotation",.2*(a()-.5));r(this,"scale",0);r(this,"deltaScale",.1);r(this,"toKeep",!0);this.x=t,this.y=d}update(){this.rotationX+=this.deltaRotation,this.rotationY+=this.deltaRotation,this.rotationZ+=this.deltaRotation,this.scale<1&&(this.scale+=this.deltaScale)}}function F(){const o=document.createElement("canvas"),t=o.getContext("2d");return o.width=o.height=0,function(){s.width=0,s.height=0;const d=R.split(`
`),C=d.reduce((e,n)=>n.length>e.length?n:e," ").length*T,_=d.length*T;o.width=C,o.height=_,t.font=`${T}px ${$}`,t.fillStyle="red";for(let e=0,n=d.length;e<n;e++)t.fillText(d[e],0,(e+.8)*(_/n));const tt=t.getImageData(0,0,C,_),B=1;for(let e=0;e<_;e+=B)for(let n=0;n<C;n+=B){const w=`x:${n}y:${e}`;if(tt.data[(n+e*C)*4]>0)if(n>s.width&&(s.width=n),e>s.height&&(s.height=e),m[w])m[w].toKeep=!0;else{const S=new j(n*u,-e*u);f.push(S),m[w]=S}else m[w]&&(m[w].toKeep=!1,delete m[w]);f=f.filter(S=>S.toKeep)}}}function N(){b=new dt(.35,.15,16,50),E=new ht({}),i=new G(b,E,f.length),i.position.x=-.5*s.width*u,i.position.y=-1.5*s.height*u,c.add(i),p=new ut}function O(){c.remove(i),i=new G(b,E,f.length),i.position.x=-.5*s.width*u,i.position.y=-1.5*s.height*u,c.add(i)}function I(){let o=0;f.forEach(t=>{p.rotation.set(t.rotationX,t.rotationY,t.rotationZ),p.scale.set(t.scale,t.scale,t.scale),p.position.set(t.x,s.height+t.y,t.z),p.updateMatrix(),i.setMatrixAt(o,p.matrix),o++,t.update()}),i.instanceMatrix.needsUpdate=!0}function U(){P=yt(),D.value.append(P.dom)}function X(){A=new Ct(v,y.domElement),A.object.position.set(0,0,30),A.target.set(0,0,0)}function Y(){c.add(new ft(1e3))}function Z(){g=window.innerWidth,x=window.innerHeight,v.aspect=g/x,v.updateProjectionMatrix(),y.setSize(g,x)}function q(){c=new mt,c.background=new pt(4473924),v=new wt(75,g/x,1,4e3),y=new gt({canvas:k.value,antialias:!0}),y.setSize(g,x),window.addEventListener("resize",Z)}function J(){const o=new xt(4210752);c.add(o)}function Q(){I()}let L=0;function K(){L=requestAnimationFrame(K),P.update(),Q(),y.render(c,v)}return ot(()=>{cancelAnimationFrame(L)}),it(()=>{q(),X(),H=F(),H(),N(),I(),J(),Y(),U(),K()}),(o,t)=>(st(),rt("div",_t,[lt(z("textarea",{"onUpdate:modelValue":t[0]||(t[0]=d=>M.value=d),class:"input",type:"text",rows:"5",cols:"50",onKeyup:V},null,544),[[ct,M.value]]),z("div",{ref_key:"canvasCon",ref:D,class:"canvasCon"},[z("canvas",{ref_key:"canvasDom",ref:k,class:"canvas"},null,512)],512)]))}}),bt=vt(St,[["__scopeId","data-v-4f5f8d30"]]);export{bt as default};
